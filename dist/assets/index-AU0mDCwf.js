(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const Ur="Logging",Kr="x-amz-user-agent",$r="NoHubcallbackProvidedException";var O;(function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE",e.NONE="NONE"})(O||(O={}));const Ct={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class _{constructor(t,n=O.WARN){this.name=t,this.level=n,this._pluggables=[]}_padding(t){return t<10?"0"+t:""+t}_ts(){const t=new Date;return[this._padding(t.getMinutes()),this._padding(t.getSeconds())].join(":")+"."+t.getMilliseconds()}configure(t){return t?(this._config=t,this._config):this._config}_log(t,...n){let r=this.level;_.LOG_LEVEL&&(r=_.LOG_LEVEL),typeof window<"u"&&window.LOG_LEVEL&&(r=window.LOG_LEVEL);const o=Ct[r];if(!(Ct[t]>=o))return;let s=console.log.bind(console);t===O.ERROR&&console.error&&(s=console.error.bind(console)),t===O.WARN&&console.warn&&(s=console.warn.bind(console)),_.BIND_ALL_LOG_LEVELS&&(t===O.INFO&&console.info&&(s=console.info.bind(console)),t===O.DEBUG&&console.debug&&(s=console.debug.bind(console)));const c=`[${t}] ${this._ts()} ${this.name}`;let a="";if(n.length===1&&typeof n[0]=="string")a=`${c} - ${n[0]}`,s(a);else if(n.length===1)a=`${c} ${n[0]}`,s(c,n[0]);else if(typeof n[0]=="string"){let u=n.slice(1);u.length===1&&(u=u[0]),a=`${c} - ${n[0]} ${u}`,s(`${c} - ${n[0]}`,u)}else a=`${c} ${n}`,s(c,n);for(const u of this._pluggables){const d={message:a,timestamp:Date.now()};u.pushLogs([d])}}log(...t){this._log(O.INFO,...t)}info(...t){this._log(O.INFO,...t)}warn(...t){this._log(O.WARN,...t)}error(...t){this._log(O.ERROR,...t)}debug(...t){this._log(O.DEBUG,...t)}verbose(...t){this._log(O.VERBOSE,...t)}addPluggable(t){t&&t.getCategoryName()===Ur&&(this._pluggables.push(t),t.configure(this._config))}listPluggables(){return this._pluggables}}_.LOG_LEVEL=null;_.BIND_ALL_LOG_LEVELS=!1;class N extends Error{constructor({message:t,name:n,recoverySuggestion:r,underlyingError:o}){super(t),this.name=n,this.underlyingError=o,this.recoverySuggestion=r,this.constructor=N,Object.setPrototypeOf(this,N.prototype)}}var j;(function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown",e.NetworkError="NetworkError"})(j||(j={}));const En=(e,t=N)=>(n,r,o)=>{const{message:i,recoverySuggestion:s}=e[r];if(!n)throw new t({name:r,message:o?`${i} ${o}`:i,recoverySuggestion:s})},se=typeof Symbol<"u"?Symbol("amplify_default"):"@@amplify_default",te=new _("Hub");class Vr{constructor(t){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=t}_remove(t,n){const r=this.listeners.get(t);if(!r){te.warn(`No listeners for ${t}`);return}this.listeners.set(t,[...r.filter(({callback:o})=>o!==n)])}dispatch(t,n,r,o){typeof t=="string"&&this.protectedChannels.indexOf(t)>-1&&(o===se||te.warn(`WARNING: ${t} is protected and dispatching on it can have unintended consequences`));const i={channel:t,payload:{...n},source:r,patternInfo:[]};try{this._toListeners(i)}catch(s){te.error(s)}}listen(t,n,r="noname"){let o;if(typeof n!="function")throw new N({name:$r,message:"No callback supplied to Hub"});o=n;let i=this.listeners.get(t);return i||(i=[],this.listeners.set(t,i)),i.push({name:r,callback:o}),()=>{this._remove(t,o)}}_toListeners(t){const{channel:n,payload:r}=t,o=this.listeners.get(n);o&&o.forEach(i=>{te.debug(`Dispatching to ${n} with `,r);try{i.callback(t)}catch(s){te.error(s)}})}}const Ne=new Vr("__default__"),Wr=()=>{if(typeof window<"u"&&typeof window.btoa=="function")return window.btoa;if(typeof btoa=="function")return btoa;throw new N({name:"Base64EncoderError",message:"Cannot resolve the `btoa` function from the environment."})},Fr=()=>{if(typeof window<"u"&&typeof window.atob=="function")return window.atob;if(typeof atob=="function")return atob;throw new N({name:"Base64EncoderError",message:"Cannot resolve the `atob` function from the environment."})},Hr={convert(e){return Fr()(e)}};var V;(function(e){e.AuthTokenConfigException="AuthTokenConfigException",e.AuthUserPoolAndIdentityPoolException="AuthUserPoolAndIdentityPoolException",e.AuthUserPoolException="AuthUserPoolException",e.InvalidIdentityPoolIdException="InvalidIdentityPoolIdException",e.OAuthNotConfigureException="OAuthNotConfigureException"})(V||(V={}));const Gr={[V.AuthTokenConfigException]:{message:"Auth Token Provider not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app."},[V.AuthUserPoolAndIdentityPoolException]:{message:"Auth UserPool or IdentityPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with UserPoolId and IdentityPoolId."},[V.AuthUserPoolException]:{message:"Auth UserPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with userPoolId and userPoolClientId."},[V.InvalidIdentityPoolIdException]:{message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."},[V.OAuthNotConfigureException]:{message:"oauth param not configured.",recoverySuggestion:"Make sure to call Amplify.configure with oauth parameter in your app."}},_n=En(Gr);function T(e){let t=!0;e?t=!!e.userPoolId&&!!e.userPoolClientId:t=!1,_n(t,V.AuthUserPoolException)}function Ee(e){const t=!!e?.identityPoolId;_n(t,V.InvalidIdentityPoolIdException)}function ae(e){const t=e.split(".");if(t.length!==3)throw new Error("Invalid token");try{const r=t[1].replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(Hr.convert(r).split("").map(s=>`%${`00${s.charCodeAt(0).toString(16)}`.slice(-2)}`).join("")),i=JSON.parse(o);return{toString:()=>e,payload:i}}catch{throw new Error("Invalid token payload")}}const An=e=>e&&e["nonRetryable"],ye=new _("retryUtil");async function jr(e,t,n,r){if(typeof e!="function")throw Error("functionToRetry must be a function");return new Promise(async(o,i)=>{let s=0,c=!1,a=()=>{},u;for(;;){s++,ye.debug(`${e.name} attempt #${s} with this vars: ${JSON.stringify(t)}`);try{o(await e(...t));return}catch(d){if(u=d,ye.debug(`error on ${e.name}`,d),An(d)){ye.debug(`${e.name} non retryable error`,d),i(d);return}const l=n(s,t,d);if(ye.debug(`${e.name} retrying in ${l} ms`),l===!1||c){i(d);return}else await new Promise(h=>{a=h,setTimeout(a,l)})}}i(u)})}const Cn=e=>{const t=Reflect.ownKeys(e);for(const n of t){const r=e[n];(r&&typeof r=="object"||typeof r=="function")&&Cn(r)}return Object.freeze(e)},qr=new _("parseAWSExports"),Br={API_KEY:"apiKey",AWS_IAM:"iam",AMAZON_COGNITO_USER_POOLS:"userPool",OPENID_CONNECT:"oidc",NONE:"none",AWS_LAMBDA:"lambda",LAMBDA:"lambda"},zr=(e={})=>{if(!Object.prototype.hasOwnProperty.call(e,"aws_project_region"))throw new N({name:"InvalidParameterException",message:"Invalid config parameter.",recoverySuggestion:"Ensure passing the config object imported from  `amplifyconfiguration.json`."});const{aws_appsync_apiKey:t,aws_appsync_authenticationType:n,aws_appsync_graphqlEndpoint:r,aws_appsync_region:o,aws_bots_config:i,aws_cognito_identity_pool_id:s,aws_cognito_sign_up_verification_method:c,aws_cognito_mfa_configuration:a,aws_cognito_mfa_types:u,aws_cognito_password_protection_settings:d,aws_cognito_verification_mechanisms:l,aws_cognito_signup_attributes:h,aws_cognito_social_providers:f,aws_cognito_username_attributes:p,aws_mandatory_sign_in:g,aws_mobile_analytics_app_id:A,aws_mobile_analytics_app_region:P,aws_user_files_s3_bucket:B,aws_user_files_s3_bucket_region:z,aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing:pe,aws_user_pools_id:K,aws_user_pools_web_client_id:Or,geo:bt,oauth:We,predictions:J,aws_cloud_logic_custom:wt,Notifications:kr,modelIntrospection:vt}=e,w={};A&&(w.Analytics={Pinpoint:{appId:A,region:P}});const{InAppMessaging:Fe,Push:He}=kr??{};if(Fe?.AWSPinpoint||He?.AWSPinpoint){if(Fe?.AWSPinpoint){const{appId:m,region:H}=Fe.AWSPinpoint;w.Notifications={InAppMessaging:{Pinpoint:{appId:m,region:H}}}}if(He?.AWSPinpoint){const{appId:m,region:H}=He.AWSPinpoint;w.Notifications={...w.Notifications,PushNotification:{Pinpoint:{appId:m,region:H}}}}}if(Array.isArray(i)&&(w.Interactions={LexV1:Object.fromEntries(i.map(m=>[m.name,m]))}),r){const m=Br[n];m||qr.debug(`Invalid authentication type ${n}. Falling back to IAM.`),w.API={GraphQL:{endpoint:r,apiKey:t,region:o,defaultAuthMode:m??"iam"}},vt&&(w.API.GraphQL.modelIntrospection=vt)}const Nr=a?{status:a&&a.toLowerCase(),totpEnabled:u?.includes("TOTP")??!1,smsEnabled:u?.includes("SMS")??!1}:void 0,Rr=d?{minLength:d.passwordPolicyMinLength,requireLowercase:d.passwordPolicyCharacters?.includes("REQUIRES_LOWERCASE")??!1,requireUppercase:d.passwordPolicyCharacters?.includes("REQUIRES_UPPERCASE")??!1,requireNumbers:d.passwordPolicyCharacters?.includes("REQUIRES_NUMBERS")??!1,requireSpecialCharacters:d.passwordPolicyCharacters?.includes("REQUIRES_SYMBOLS")??!1}:void 0,Pr=Array.from(new Set([...l??[],...h??[]])).reduce((m,H)=>({...m,[H.toLowerCase()]:{required:!0}}),{}),It=p?.includes("EMAIL")??!1,Et=p?.includes("PHONE_NUMBER")??!1;(s||K)&&(w.Auth={Cognito:{identityPoolId:s,allowGuestAccess:g!=="enable",signUpVerificationMethod:c,userAttributes:Pr,userPoolClientId:Or,userPoolId:K,mfa:Nr,passwordFormat:Rr,loginWith:{username:!(It||Et),email:It,phone:Et}}});const xr=We?Object.keys(We).length>0:!1,Dr=f?f.length>0:!1;if(w.Auth&&xr&&(w.Auth.Cognito.loginWith={...w.Auth.Cognito.loginWith,oauth:{...Jr(We),...Dr&&{providers:Qr(f)}}}),B&&(w.Storage={S3:{bucket:B,region:z,dangerouslyConnectToHttpEndpointForTesting:pe}}),bt){const{amazon_location_service:m}=bt;w.Geo={LocationService:{maps:m.maps,geofenceCollections:m.geofenceCollections,searchIndices:m.search_indices,region:m.region}}}if(wt&&(w.API={...w.API,REST:wt.reduce((m,H)=>{const{name:Lr,endpoint:Mr,region:_t,service:At}=H;return{...m,[Lr]:{endpoint:Mr,...At?{service:At}:void 0,..._t?{region:_t}:void 0}}},{})}),J){const{VoiceId:m}=J?.convert?.speechGenerator?.defaults??{};w.Predictions=m?{...J,convert:{...J.convert,speechGenerator:{...J.convert.speechGenerator,defaults:{voiceId:m}}}}:J}return w},Tt=e=>e?.split(",")??[],Jr=({domain:e,scope:t,redirectSignIn:n,redirectSignOut:r,responseType:o})=>({domain:e,scopes:t,redirectSignIn:Tt(n),redirectSignOut:Tt(r),responseType:o}),Qr=e=>e.map(t=>{const n=t.toLowerCase();return n.charAt(0).toUpperCase()+n.slice(1)}),Yr=Symbol("oauth-listener");let me;const Xr=new Uint8Array(16);function Zr(){if(!me&&(me=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!me))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return me(Xr)}const v=[];for(let e=0;e<256;++e)v.push((e+256).toString(16).slice(1));function eo(e,t=0){return v[e[t+0]]+v[e[t+1]]+v[e[t+2]]+v[e[t+3]]+"-"+v[e[t+4]]+v[e[t+5]]+"-"+v[e[t+6]]+v[e[t+7]]+"-"+v[e[t+8]]+v[e[t+9]]+"-"+v[e[t+10]]+v[e[t+11]]+v[e[t+12]]+v[e[t+13]]+v[e[t+14]]+v[e[t+15]]}const to=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ot={randomUUID:to};function no(e,t,n){if(Ot.randomUUID&&!t&&!e)return Ot.randomUUID();e=e||{};const r=e.random||(e.rng||Zr)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n=n||0;for(let o=0;o<16;++o)t[n+o]=r[o];return t}return eo(r)}function ro(e){const{version:t}=e;return t?t.startsWith("1"):!1}function oo(e){if(!e)return;const{bucket_name:t,aws_region:n,buckets:r}=e;return{S3:{bucket:t,region:n,buckets:r&&yo(r)}}}function io(e){if(!e)return;const{user_pool_id:t,user_pool_client_id:n,identity_pool_id:r,password_policy:o,mfa_configuration:i,mfa_methods:s,unauthenticated_identities_enabled:c,oauth:a,username_attributes:u,standard_required_attributes:d}=e,l={Cognito:{userPoolId:t,userPoolClientId:n}};return r&&(l.Cognito={...l.Cognito,identityPoolId:r}),o&&(l.Cognito.passwordFormat={requireLowercase:o.require_lowercase,requireNumbers:o.require_numbers,requireUppercase:o.require_uppercase,requireSpecialCharacters:o.require_symbols,minLength:o.min_length??6}),i&&(l.Cognito.mfa={status:po(i),smsEnabled:s?.includes("SMS"),totpEnabled:s?.includes("TOTP")}),c&&(l.Cognito.allowGuestAccess=c),a&&(l.Cognito.loginWith={oauth:{domain:a.domain,redirectSignIn:a.redirect_sign_in_uri,redirectSignOut:a.redirect_sign_out_uri,responseType:a.response_type==="token"?"token":"code",scopes:a.scopes,providers:go(a.identity_providers)}}),u&&(l.Cognito.loginWith={...l.Cognito.loginWith,email:u.includes("email"),phone:u.includes("phone_number"),username:u.includes("username")}),d&&(l.Cognito.userAttributes=d.reduce((h,f)=>({...h,[f]:{required:!0}}),{})),l}function so(e){if(!e?.amazon_pinpoint)return;const{amazon_pinpoint:t}=e;return{Pinpoint:{appId:t.app_id,region:t.aws_region}}}function ao(e){if(!e)return;const{aws_region:t,geofence_collections:n,maps:r,search_indices:o}=e;return{LocationService:{region:t,searchIndices:o,geofenceCollections:n,maps:r}}}function co(e){if(!e)return;const{aws_region:t,default_authorization_type:n,url:r,api_key:o,model_introspection:i}=e;return{GraphQL:{endpoint:r,defaultAuthMode:Tn(n),region:t,apiKey:o,modelIntrospection:i}}}function uo(e){if(!e?.events)return;const{url:t,aws_region:n,api_key:r,default_authorization_type:o}=e.events;return{Events:{endpoint:t,defaultAuthMode:Tn(o),region:n,apiKey:r}}}function lo(e){if(!e)return;const{aws_region:t,channels:n,amazon_pinpoint_app_id:r}=e,o=n.includes("IN_APP_MESSAGING"),i=n.includes("APNS")||n.includes("FCM");if(!(o||i))return;const s={};return o&&(s.InAppMessaging={Pinpoint:{appId:r,region:t}}),i&&(s.PushNotification={Pinpoint:{appId:r,region:t}}),s}function fo(e){const t={};if(e.storage&&(t.Storage=oo(e.storage)),e.auth&&(t.Auth=io(e.auth)),e.analytics&&(t.Analytics=so(e.analytics)),e.geo&&(t.Geo=ao(e.geo)),e.data&&(t.API=co(e.data)),e.custom){const n=uo(e.custom);n&&"Events"in n&&(t.API={...t.API,...n})}return e.notifications&&(t.Notifications=lo(e.notifications)),t}const ho={AMAZON_COGNITO_USER_POOLS:"userPool",API_KEY:"apiKey",AWS_IAM:"iam",AWS_LAMBDA:"lambda",OPENID_CONNECT:"oidc"};function Tn(e){return ho[e]}const kt={GOOGLE:"Google",LOGIN_WITH_AMAZON:"Amazon",FACEBOOK:"Facebook",SIGN_IN_WITH_APPLE:"Apple"};function go(e=[]){return e.reduce((t,n)=>(kt[n]!==void 0&&t.push(kt[n]),t),[])}function po(e){return e==="OPTIONAL"?"optional":e==="REQUIRED"?"on":"off"}function yo(e){const t={};return e.forEach(({name:n,bucket_name:r,aws_region:o})=>{if(n in t)throw new Error(`Duplicate friendly name found: ${n}. Name must be unique.`);t[n]={bucketName:r,region:o}}),t}const On=e=>Object.keys(e).some(t=>t.startsWith("aws_"))?zr(e):ro(e)?fo(e):e;function Nt({expiresAt:e,clockDrift:t}){return Date.now()+t>e}class mo{configure(t,n){this.authConfig=t,this.authOptions=n}async fetchAuthSession(t={}){let n,r;const o=await this.getTokens(t);return o?(r=o.accessToken?.payload?.sub,n=await this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({authConfig:this.authConfig,tokens:o,authenticated:!0,forceRefresh:t.forceRefresh})):n=await this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({authConfig:this.authConfig,authenticated:!1,forceRefresh:t.forceRefresh}),{tokens:o,credentials:n?.credentials,identityId:n?.identityId,userSub:r}}async clearCredentials(){await this.authOptions?.credentialsProvider?.clearCredentialsAndIdentityId()}async getTokens(t){return await this.authOptions?.tokenProvider?.getTokens(t)??void 0}}var ze=function(e,t){return ze=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},ze(e,t)};function it(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");ze(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function kn(e,t,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function c(d){try{u(r.next(d))}catch(l){s(l)}}function a(d){try{u(r.throw(d))}catch(l){s(l)}}function u(d){d.done?i(d.value):o(d.value).then(c,a)}u((r=r.apply(e,t||[])).next())})}function st(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=c(0),s.throw=c(1),s.return=c(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function c(u){return function(d){return a([u,d])}}function a(u){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(n=0)),n;)try{if(r=1,o&&(i=u[0]&2?o.return:u[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,u[1])).done)return i;switch(o=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,o=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(d){u=[6,d],o=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function ce(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Je(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),o,i=[],s;try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)i.push(o.value)}catch(c){s={error:c}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return i}function Qe(e,t,n){if(n||arguments.length===2)for(var r=0,o=t.length,i;r<o;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}function Q(e){return this instanceof Q?(this.v=e,this):new Q(e)}function So(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),o,i=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",s),o[Symbol.asyncIterator]=function(){return this},o;function s(f){return function(p){return Promise.resolve(p).then(f,l)}}function c(f,p){r[f]&&(o[f]=function(g){return new Promise(function(A,P){i.push([f,g,A,P])>1||a(f,g)})},p&&(o[f]=p(o[f])))}function a(f,p){try{u(r[f](p))}catch(g){h(i[0][3],g)}}function u(f){f.value instanceof Q?Promise.resolve(f.value.v).then(d,l):h(i[0][2],f)}function d(f){a("next",f)}function l(f){a("throw",f)}function h(f,p){f(p),i.shift(),i.length&&a(i[0][0],i[0][1])}}function bo(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof ce=="function"?ce(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=e[i]&&function(s){return new Promise(function(c,a){s=e[i](s),o(c,a,s.done,s.value)})}}function o(i,s,c,a){Promise.resolve(a).then(function(u){i({value:u,done:c})},s)}}var x=64,wo=32,vo=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Io=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Eo=Math.pow(2,53)-1,_e=function(){function e(){this.state=Int32Array.from(Io),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(t){if(this.finished)throw new Error("Attempted to update an already finished hash.");var n=0,r=t.byteLength;if(this.bytesHashed+=r,this.bytesHashed*8>Eo)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;r>0;)this.buffer[this.bufferLength++]=t[n++],r--,this.bufferLength===x&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var t=this.bytesHashed*8,n=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),r=this.bufferLength;if(n.setUint8(this.bufferLength++,128),r%x>=x-8){for(var o=this.bufferLength;o<x;o++)n.setUint8(o,0);this.hashBuffer(),this.bufferLength=0}for(var o=this.bufferLength;o<x-8;o++)n.setUint8(o,0);n.setUint32(x-8,Math.floor(t/4294967296),!0),n.setUint32(x-4,t),this.hashBuffer(),this.finished=!0}for(var i=new Uint8Array(wo),o=0;o<8;o++)i[o*4]=this.state[o]>>>24&255,i[o*4+1]=this.state[o]>>>16&255,i[o*4+2]=this.state[o]>>>8&255,i[o*4+3]=this.state[o]>>>0&255;return i},e.prototype.hashBuffer=function(){for(var t=this,n=t.buffer,r=t.state,o=r[0],i=r[1],s=r[2],c=r[3],a=r[4],u=r[5],d=r[6],l=r[7],h=0;h<x;h++){if(h<16)this.temp[h]=(n[h*4]&255)<<24|(n[h*4+1]&255)<<16|(n[h*4+2]&255)<<8|n[h*4+3]&255;else{var f=this.temp[h-2],p=(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10;f=this.temp[h-15];var g=(f>>>7|f<<25)^(f>>>18|f<<14)^f>>>3;this.temp[h]=(p+this.temp[h-7]|0)+(g+this.temp[h-16]|0)}var A=(((a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7))+(a&u^~a&d)|0)+(l+(vo[h]+this.temp[h]|0)|0)|0,P=((o>>>2|o<<30)^(o>>>13|o<<19)^(o>>>22|o<<10))+(o&i^o&s^i&s)|0;l=d,d=u,u=a,a=c+A|0,c=s,s=i,i=o,o=A+P|0}r[0]+=o,r[1]+=i,r[2]+=s,r[3]+=c,r[4]+=a,r[5]+=u,r[6]+=d,r[7]+=l},e}();const _o=e=>new TextEncoder().encode(e);var Ao=typeof Buffer<"u"&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:_o;function Nn(e){return e instanceof Uint8Array?e:typeof e=="string"?Ao(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}function Co(e){return typeof e=="string"?e.length===0:e.byteLength===0}var To=function(){function e(t){this.secret=t,this.hash=new _e,this.reset()}return e.prototype.update=function(t){if(!(Co(t)||this.error))try{this.hash.update(Nn(t))}catch(n){this.error=n}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return kn(this,void 0,void 0,function(){return st(this,function(t){return[2,this.digestSync()]})})},e.prototype.reset=function(){if(this.hash=new _e,this.secret){this.outer=new _e;var t=Oo(this.secret),n=new Uint8Array(x);n.set(t);for(var r=0;r<x;r++)t[r]^=54,n[r]^=92;this.hash.update(t),this.outer.update(n);for(var r=0;r<t.byteLength;r++)t[r]=0}},e}();function Oo(e){var t=Nn(e);if(t.byteLength>x){var n=new _e;n.update(t),t=n.digest()}var r=new Uint8Array(x);return r.set(t),r}const Rn={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),Rn[e]=t}function ko(e){let t="";for(let n=0;n<e.byteLength;n++)t+=Rn[e[n]];return t}var S;(function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"})(S||(S={}));var Rt;(function(e){e.AI="ai",e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"})(Rt||(Rt={}));var Pt;(function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnMessage="7",e.Generation="8",e.UpdateConversation="9"})(Pt||(Pt={}));var xt;(function(e){e.Record="1",e.IdentifyUser="2"})(xt||(xt={}));var Dt;(function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"})(Dt||(Dt={}));var Lt;(function(e){e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36"})(Lt||(Lt={}));var Mt;(function(e){e.Subscribe="1",e.GraphQl="2"})(Mt||(Mt={}));var Ut;(function(e){e.SearchByText="0",e.SearchByCoordinates="1",e.SearchForSuggestions="2",e.SearchByPlaceId="3",e.SaveGeofences="4",e.GetGeofence="5",e.ListGeofences="6",e.DeleteGeofences="7"})(Ut||(Ut={}));var Kt;(function(e){e.SyncMessages="1",e.IdentifyUser="2",e.NotifyMessageInteraction="3"})(Kt||(Kt={}));var $t;(function(e){e.None="0"})($t||($t={}));var Vt;(function(e){e.Convert="1",e.Identify="2",e.Interpret="3"})(Vt||(Vt={}));var Wt;(function(e){e.Subscribe="1"})(Wt||(Wt={}));var Ft;(function(e){e.InitializePushNotifications="1",e.IdentifyUser="2"})(Ft||(Ft={}));var Ht;(function(e){e.UploadData="1",e.DownloadData="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6",e.GetUrl="7"})(Ht||(Ht={}));const No="6.8.2",Me=()=>typeof global<"u",Z=()=>typeof window<"u",Pn=()=>typeof document<"u",at=()=>typeof process<"u",ue=(e,t)=>!!Object.keys(e).find(n=>n.startsWith(t));var Gt={};function Ro(){const e=r=>r.startsWith("_react")||r.startsWith("__react"),t=r=>Object.keys(r).find(e),n=()=>Array.from(document.querySelectorAll("[id]"));return Pn()&&n().some(t)}function Po(){return at()&&typeof Gt<"u"&&!!Object.keys(Gt).find(e=>e.includes("react"))}function xo(){return Z()&&ue(window,"__VUE")}function Do(){return Me()&&ue(global,"__VUE")}var jt={};function Lo(){return Z()&&ue(window,"__SVELTE")}function Mo(){return at()&&typeof jt<"u"&&!!Object.keys(jt).find(e=>e.includes("svelte"))}function Uo(){return Z()&&window.next&&typeof window.next=="object"}function Ko(){return Me()&&(ue(global,"__next")||ue(global,"__NEXT"))}function $o(){return Z()&&(window.__NUXT__!==void 0||window.$nuxt!==void 0)}function Vo(){return Me()&&typeof global.__NUXT_PATHS__<"u"}var qt={};function Wo(){const e=!!(Pn()&&document.querySelector("[ng-version]")),t=!!(Z()&&typeof window.ng<"u");return e||t}function Fo(){return at()&&typeof qt=="object"&&qt.npm_lifecycle_script?.startsWith("ng ")||!1}function Ho(){return typeof navigator<"u"&&typeof navigator.product<"u"&&navigator.product==="ReactNative"}function Go(){return Me()&&typeof global.expo<"u"}function jo(){return Z()}const qo=[{platform:S.Expo,detectionMethod:Go},{platform:S.ReactNative,detectionMethod:Ho},{platform:S.NextJs,detectionMethod:Uo},{platform:S.Nuxt,detectionMethod:$o},{platform:S.Angular,detectionMethod:Wo},{platform:S.React,detectionMethod:Ro},{platform:S.VueJs,detectionMethod:xo},{platform:S.Svelte,detectionMethod:Lo},{platform:S.WebUnknown,detectionMethod:jo},{platform:S.NextJsSSR,detectionMethod:Ko},{platform:S.NuxtSSR,detectionMethod:Vo},{platform:S.ReactSSR,detectionMethod:Po},{platform:S.VueJsSSR,detectionMethod:Do},{platform:S.AngularSSR,detectionMethod:Fo},{platform:S.SvelteSSR,detectionMethod:Mo}];function Bo(){return qo.find(e=>e.detectionMethod())?.platform||S.ServerSideUnknown}let ie;const Ae=[];let Re=!1;const zo=10,Jo=10,Qo=1e3,xn=()=>{if(!ie){if(ie=Bo(),Re)for(;Ae.length;)Ae.pop()?.();else Ae.forEach(e=>{e()});Bt(S.ServerSideUnknown,zo),Bt(S.WebUnknown,Jo)}return ie},Yo=e=>{Re||Ae.push(e)};function Xo(){ie=void 0}function Bt(e,t){ie===e&&!Re&&setTimeout(()=>{Xo(),Re=!0,setTimeout(xn,Qo)},t)}const Zo={},ei=(e,t)=>Zo[e]?.[t]?.additionalDetails,ti="aws-amplify",ni=e=>e.replace(/\+.*/,""),ri=({category:e,action:t}={})=>{const n=[[ti,ni(No)]];if(e&&n.push([e,t]),n.push(["framework",xn()]),e&&t){const r=ei(e,t);r&&r.forEach(o=>{n.push(o)})}return n},ge=e=>ri(e).map(([r,o])=>r&&o?`${r}/${o}`:r).join(" ");function I(e){return typeof e=="function"}function oi(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Ge=oi(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,o){return o+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function zt(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var ct=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,o,i;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var c=ce(s),a=c.next();!a.done;a=c.next()){var u=a.value;u.remove(this)}}catch(g){t={error:g}}finally{try{a&&!a.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}else s.remove(this);var d=this.initialTeardown;if(I(d))try{d()}catch(g){i=g instanceof Ge?g.errors:[g]}var l=this._finalizers;if(l){this._finalizers=null;try{for(var h=ce(l),f=h.next();!f.done;f=h.next()){var p=f.value;try{Jt(p)}catch(g){i=i??[],g instanceof Ge?i=Qe(Qe([],Je(i)),Je(g.errors)):i.push(g)}}}catch(g){r={error:g}}finally{try{f&&!f.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}}if(i)throw new Ge(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)Jt(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&zt(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&zt(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}();ct.EMPTY;function Dn(e){return e instanceof ct||e&&"closed"in e&&I(e.remove)&&I(e.add)&&I(e.unsubscribe)}function Jt(e){I(e)?e():e.unsubscribe()}var ii={Promise:void 0},si={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,Qe([e,t],Je(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function Ln(e){si.setTimeout(function(){throw e})}function Qt(){}function ai(e){e()}var ut=function(e){it(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,Dn(n)&&n.add(r)):r.destination=di,r}return t.create=function(n,r,o){return new Ye(n,r,o)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(ct),ci=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){Se(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){Se(r)}else Se(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){Se(n)}},e}(),Ye=function(e){it(t,e);function t(n,r,o){var i=e.call(this)||this,s;return I(n)||!n?s={next:n??void 0,error:r??void 0,complete:o??void 0}:s=n,i.destination=new ci(s),i}return t}(ut);function Se(e){Ln(e)}function ui(e){throw e}var di={closed:!0,next:Qt,error:ui,complete:Qt},dt=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function li(e){return e}function fi(e){return e.length===0?li:e.length===1?e[0]:function(n){return e.reduce(function(r,o){return o(r)},n)}}var R=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var o=this,i=gi(t)?t:new Ye(t,n,r);return ai(function(){var s=o,c=s.operator,a=s.source;i.add(c?c.call(i,a):a?o._subscribe(i):o._trySubscribe(i))}),i},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=Yt(n),new n(function(o,i){var s=new Ye({next:function(c){try{t(c)}catch(a){i(a),s.unsubscribe()}},error:i,complete:o});r.subscribe(s)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[dt]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return fi(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=Yt(t),new t(function(r,o){var i;n.subscribe(function(s){return i=s},function(s){return o(s)},function(){return r(i)})})},e.create=function(t){return new e(t)},e}();function Yt(e){var t;return(t=e??ii.Promise)!==null&&t!==void 0?t:Promise}function hi(e){return e&&I(e.next)&&I(e.error)&&I(e.complete)}function gi(e){return e&&e instanceof ut||hi(e)&&Dn(e)}function pi(e){return I(e?.lift)}function Ue(e){return function(t){if(pi(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function lt(e,t,n,r,o){return new yi(e,t,n,r,o)}var yi=function(e){it(t,e);function t(n,r,o,i,s,c){var a=e.call(this,n)||this;return a.onFinalize=s,a.shouldUnsubscribe=c,a._next=r?function(u){try{r(u)}catch(d){n.error(d)}}:e.prototype._next,a._error=i?function(u){try{i(u)}catch(d){n.error(d)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=o?function(){try{o()}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._complete,a}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t}(ut),Mn=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function Un(e){return I(e?.then)}function Kn(e){return I(e[dt])}function $n(e){return Symbol.asyncIterator&&I(e?.[Symbol.asyncIterator])}function Vn(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function mi(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Wn=mi();function Fn(e){return I(e?.[Wn])}function Hn(e){return So(this,arguments,function(){var n,r,o,i;return st(this,function(s){switch(s.label){case 0:n=e.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,Q(n.read())];case 3:return r=s.sent(),o=r.value,i=r.done,i?[4,Q(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,Q(o)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function Gn(e){return I(e?.getReader)}function ft(e){if(e instanceof R)return e;if(e!=null){if(Kn(e))return Si(e);if(Mn(e))return bi(e);if(Un(e))return wi(e);if($n(e))return jn(e);if(Fn(e))return vi(e);if(Gn(e))return Ii(e)}throw Vn(e)}function Si(e){return new R(function(t){var n=e[dt]();if(I(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function bi(e){return new R(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function wi(e){return new R(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,Ln)})}function vi(e){return new R(function(t){var n,r;try{for(var o=ce(e),i=o.next();!i.done;i=o.next()){var s=i.value;if(t.next(s),t.closed)return}}catch(c){n={error:c}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}t.complete()})}function jn(e){return new R(function(t){Ei(e,t).catch(function(n){return t.error(n)})})}function Ii(e){return jn(Hn(e))}function Ei(e,t){var n,r,o,i;return kn(this,void 0,void 0,function(){var s,c;return st(this,function(a){switch(a.label){case 0:a.trys.push([0,5,6,11]),n=bo(e),a.label=1;case 1:return[4,n.next()];case 2:if(r=a.sent(),!!r.done)return[3,4];if(s=r.value,t.next(s),t.closed)return[2];a.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=a.sent(),o={error:c},[3,11];case 6:return a.trys.push([6,,9,10]),r&&!r.done&&(i=n.return)?[4,i.call(n)]:[3,8];case 7:a.sent(),a.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function G(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=!1);var i=t.schedule(function(){n(),o?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(i),!o)return i}function qn(e,t){return t===void 0&&(t=0),Ue(function(n,r){n.subscribe(lt(r,function(o){return G(r,e,function(){return r.next(o)},t)},function(){return G(r,e,function(){return r.complete()},t)},function(o){return G(r,e,function(){return r.error(o)},t)}))})}function Bn(e,t){return t===void 0&&(t=0),Ue(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function _i(e,t){return ft(e).pipe(Bn(t),qn(t))}function Ai(e,t){return ft(e).pipe(Bn(t),qn(t))}function Ci(e,t){return new R(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function Ti(e,t){return new R(function(n){var r;return G(n,t,function(){r=e[Wn](),G(n,t,function(){var o,i,s;try{o=r.next(),i=o.value,s=o.done}catch(c){n.error(c);return}s?n.complete():n.next(i)},0,!0)}),function(){return I(r?.return)&&r.return()}})}function zn(e,t){if(!e)throw new Error("Iterable cannot be null");return new R(function(n){G(n,t,function(){var r=e[Symbol.asyncIterator]();G(n,t,function(){r.next().then(function(o){o.done?n.complete():n.next(o.value)})},0,!0)})})}function Oi(e,t){return zn(Hn(e),t)}function ki(e,t){if(e!=null){if(Kn(e))return _i(e,t);if(Mn(e))return Ci(e,t);if(Un(e))return Ai(e,t);if($n(e))return zn(e,t);if(Fn(e))return Ti(e,t);if(Gn(e))return Oi(e,t)}throw Vn(e)}function Ni(e,t){return t?ki(e,t):ft(e)}function Ri(e,t){return Ue(function(n,r){var o=0;n.subscribe(lt(r,function(i){r.next(e.call(t,i,o++))}))})}function Pi(e,t){return Ue(function(n,r){var o=0;n.subscribe(lt(r,function(i){return e.call(t,i,o++)&&r.next(i)}))})}const xi=()=>{if(typeof self>"u")return!1;const e=self;return typeof e.WorkerGlobalScope<"u"&&self instanceof e.WorkerGlobalScope};class Y{networkMonitor(t){const n=xi()?self:typeof window<"u"&&window;return n?new R(r=>{r.next({online:n.navigator.onLine});const o=()=>{r.next({online:!0})},i=()=>{r.next({online:!1})};return n.addEventListener("online",o),n.addEventListener("offline",i),Y._observers.push(r),()=>{n.removeEventListener("online",o),n.removeEventListener("offline",i),Y._observers=Y._observers.filter(s=>s!==r)}}):Ni([{online:!0}])}static _observerOverride(t){for(const n of this._observers){if(n.closed){this._observers=this._observers.filter(r=>r!==n);continue}n?.next&&n.next(t)}}}Y._observers=[];const Di=()=>typeof window<"u"&&typeof window.document<"u";class Li{constructor(){this.oAuthListener=void 0,this.resourcesConfig={},this.libraryOptions={},this.Auth=new mo}configure(t,n){const r=On(t);this.resourcesConfig=r,n&&(this.libraryOptions=n),this.resourcesConfig=Cn(this.resourcesConfig),this.Auth.configure(this.resourcesConfig.Auth,this.libraryOptions.Auth),Ne.dispatch("core",{event:"configure",data:this.resourcesConfig},"Configure",se),this.notifyOAuthListener()}getConfig(){return this.resourcesConfig}[Yr](t){this.resourcesConfig.Auth?.Cognito.loginWith?.oauth?t(this.resourcesConfig.Auth?.Cognito):this.oAuthListener=t}notifyOAuthListener(){!this.resourcesConfig.Auth?.Cognito.loginWith?.oauth||!this.oAuthListener||(this.oAuthListener(this.resourcesConfig.Auth?.Cognito),this.oAuthListener=void 0)}}const L=new Li,Mi=(e,t)=>e.Auth.fetchAuthSession(t),Jn=e=>Mi(L,e),Ke=e=>{const{headers:t,statusCode:n}=e;return{...Ui(e)?e.$metadata:{},httpStatusCode:n,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},Ui=e=>typeof e?.$metadata=="object",ee=async e=>{if(!e||e.statusCode<300)return;const t=await $e(e),r=(s=>{const[c]=s.toString().split(/[,:]+/);return c.includes("#")?c.split("#")[1]:c})(e.headers["x-amzn-errortype"]??t.code??t.__type??"UnknownError"),o=t.message??t.Message??"Unknown error",i=new Error(o);return Object.assign(i,{name:r,$metadata:Ke(e)})},$e=async e=>{if(!e.body)throw new Error("Missing response payload");const t=await e.body.json();return Object.assign(t,{$metadata:Ke(e)})},ht=(e,t,n,r)=>async(o,i)=>{const s={...r,...o},c=await s.endpointResolver(s,i),a=await t(i,c),u=await e(a,{...s});return n(u)},Qn={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},Ki={partitions:[Qn,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},Yn=e=>{const{partitions:t}=Ki;for(const{regions:n,outputs:r,regionRegex:o}of t){const i=new RegExp(o);if(n.includes(e)||i.test(e))return r.dnsSuffix}return Qn.outputs.dnsSuffix},$i=3,Xn=({maxAttempts:e=$i,retryDecider:t,computeDelay:n,abortSignal:r})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(o,i)=>async function(c){let a,u=i.attemptsCount??0,d;const l=()=>{if(d)return Xt(d,u),d;throw Xt(a,u),a};for(;!r?.aborted&&u<e;){try{d=await o(c),a=void 0}catch(h){a=h,d=void 0}if(u=(i.attemptsCount??0)>u?i.attemptsCount??0:u+1,i.attemptsCount=u,await t(d,a)){if(!r?.aborted&&u<e){const h=n(u);await Vi(h,r)}continue}else return l()}if(r?.aborted)throw new Error("Request aborted.");return l()}},Vi=(e,t)=>{if(t?.aborted)return Promise.resolve();let n,r;const o=new Promise(i=>{r=i,n=setTimeout(i,e)});return t?.addEventListener("abort",function i(s){clearTimeout(n),t?.removeEventListener("abort",i),r()}),o},Xt=(e,t)=>{Object.prototype.toString.call(e)==="[object Object]"&&(e.$metadata={...e.$metadata??{},attempts:t})},Zn=({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>n=>async function(o){if(t.trim().length===0)return await n(o);{const i=e.toLowerCase();return o.headers[i]=o.headers[i]?`${o.headers[i]} ${t}`:t,await n(o)}},Ve=(e,t)=>(n,r)=>{const o={};let i=s=>e(s,r);for(let s=t.length-1;s>=0;s--){const c=t[s];i=c(r)(i,o)}return i(n)},je=e=>{let t;return()=>(t||(t=e()),t)},Wi=e=>!["HEAD","GET","DELETE"].includes(e.toUpperCase()),er=async({url:e,method:t,headers:n,body:r},{abortSignal:o,cache:i,withCrossDomainCredentials:s})=>{let c;try{c=await fetch(e,{method:t,headers:n,body:Wi(t)?r:void 0,signal:o,cache:i,credentials:s?"include":"same-origin"})}catch(l){throw l instanceof TypeError?new N({name:j.NetworkError,message:"A network error has occurred.",underlyingError:l}):l}const a={};c.headers?.forEach((l,h)=>{a[h.toLowerCase()]=l});const u={statusCode:c.status,headers:a,body:null},d=Object.assign(c.body??{},{text:je(()=>c.text()),blob:je(()=>c.blob()),json:je(()=>c.json())});return{...u,body:d}},gt=Ve(er,[Zn,Xn]),tr=5*60*1e3;function nr(e=tr){return r=>{const o=2**r*100+100*Math.random();return o>e?!1:o}}const Zt=5*60*1e3,pt=e=>{const n=nr(Zt)(e);return n===!1?Zt:n},Fi=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],Hi=e=>!!e&&Fi.includes(e),yt=e=>async(t,n)=>{const r=n??await e(t)??void 0,o=r?.code||r?.name,i=t?.statusCode;return Bi(n)||qi(i,o)||Hi(o)||zi(i,o)},Gi=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],ji=["TimeoutError","RequestTimeout","RequestTimeoutException"],qi=(e,t)=>e===429||!!t&&Gi.includes(t),Bi=e=>[j.NetworkError,"ERR_NETWORK"].includes(e?.name),zi=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&ji.includes(t),F=URL,rr=URLSearchParams,Ji="cognito-identity",Qi=({region:e})=>({url:new F(`https://cognito-identity.${e}.${Yn(e)}`)}),Yi=()=>e=>async function(n){return n.headers["cache-control"]="no-store",e(n)},or=Ve(gt,[Yi]),mt={service:Ji,endpointResolver:Qi,retryDecider:yt(ee),computeDelay:pt,userAgentValue:ge(),cache:"no-store"};Yo(()=>{mt.userAgentValue=ge()});const ir=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${e}`}),sr=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"}),Xi=(e,t)=>{const n=ir("GetId"),r=JSON.stringify(e);return sr(t,n,r)},Zi=async e=>{if(e.statusCode>=300)throw await ee(e);return{IdentityId:(await $e(e)).IdentityId,$metadata:Ke(e)}},es=ht(or,Xi,Zi,mt),ts=(e,t)=>{const n=ir("GetCredentialsForIdentity"),r=JSON.stringify(e);return sr(t,n,r)},ns=async e=>{if(e.statusCode>=300)throw await ee(e);{const t=await $e(e);return{IdentityId:t.IdentityId,Credentials:rs(t.Credentials),$metadata:Ke(e)}}},rs=({AccessKeyId:e,SecretKey:t,SessionToken:n,Expiration:r}={})=>({AccessKeyId:e,SecretKey:t,SessionToken:n,Expiration:r&&new Date(r*1e3)}),en=ht(or,ts,ns,mt);class be extends N{constructor(){super({name:j.PlatformNotSupported,message:"Function not supported on current platform"})}}class ar{constructor(t){this.storage=t}async setItem(t,n){if(!this.storage)throw new be;this.storage.setItem(t,n)}async getItem(t){if(!this.storage)throw new be;return this.storage.getItem(t)}async removeItem(t){if(!this.storage)throw new be;this.storage.removeItem(t)}async clear(){if(!this.storage)throw new be;this.storage.clear()}}class cr{constructor(){this.storage=new Map}get length(){return this.storage.size}key(t){return t>this.length-1?null:Array.from(this.storage.keys())[t]}setItem(t,n){this.storage.set(t,n)}getItem(t){return this.storage.get(t)??null}removeItem(t){this.storage.delete(t)}clear(){this.storage.clear()}}const ur=new _("CoreStorageUtils"),os=()=>{try{if(typeof window<"u"&&window.localStorage)return window.localStorage}catch{ur.info("localStorage not found. InMemoryStorage is used as a fallback.")}return new cr},is=()=>{try{if(typeof window<"u"&&window.sessionStorage)return window.sessionStorage.getItem("test"),window.sessionStorage;throw new Error("sessionStorage is not defined")}catch{return ur.info("sessionStorage not found. InMemoryStorage is used as a fallback."),new cr}};class ss extends ar{constructor(){super(os())}}class as extends ar{constructor(){super(is())}}/*! js-cookie v3.0.5 | MIT */function we(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}var cs={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function Xe(e,t){function n(o,i,s){if(!(typeof document>"u")){s=we({},t,s),typeof s.expires=="number"&&(s.expires=new Date(Date.now()+s.expires*864e5)),s.expires&&(s.expires=s.expires.toUTCString()),o=encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var a in s)s[a]&&(c+="; "+a,s[a]!==!0&&(c+="="+s[a].split(";")[0]));return document.cookie=o+"="+e.write(i,o)+c}}function r(o){if(!(typeof document>"u"||arguments.length&&!o)){for(var i=document.cookie?document.cookie.split("; "):[],s={},c=0;c<i.length;c++){var a=i[c].split("="),u=a.slice(1).join("=");try{var d=decodeURIComponent(a[0]);if(s[d]=e.read(u,d),o===d)break}catch{}}return o?s[o]:s}}return Object.create({set:n,get:r,remove:function(o,i){n(o,"",we({},i,{expires:-1}))},withAttributes:function(o){return Xe(this.converter,we({},this.attributes,o))},withConverter:function(o){return Xe(we({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var ve=Xe(cs,{path:"/"});class tn{constructor(t={}){const{path:n,domain:r,expires:o,sameSite:i,secure:s}=t;if(this.domain=r,this.path=n||"/",this.expires=Object.prototype.hasOwnProperty.call(t,"expires")?o:365,this.secure=Object.prototype.hasOwnProperty.call(t,"secure")?s:!0,Object.prototype.hasOwnProperty.call(t,"sameSite")){if(!i||!["strict","lax","none"].includes(i))throw new Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if(i==="none"&&!this.secure)throw new Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=i}}async setItem(t,n){ve.set(t,n,this.getData())}async getItem(t){return ve.get(t)??null}async removeItem(t){ve.remove(t,this.getData())}async clear(){const t=ve.get(),n=Object.keys(t).map(r=>this.removeItem(r));await Promise.all(n)}getData(){return{path:this.path,expires:this.expires,domain:this.domain,secure:this.secure,...this.sameSite&&{sameSite:this.sameSite}}}}const de=new ss;new as;const nn=no,dr=e=>Object.keys(e).map(t=>t.toLowerCase()).sort().join(";"),us="X-Amz-Date",ds="X-Amz-Security-Token",ls="authorization",fs="host",hs=us.toLowerCase(),gs=ds.toLowerCase(),lr="aws4_request",fr="AWS4-HMAC-SHA256",ps="AWS4",ys="e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",ms="UNSIGNED-PAYLOAD",Ss=(e,t,n)=>`${e}/${t}/${n}/${lr}`,bs=e=>{const t=e.toISOString().replace(/[:-]|\.\d{3}/g,"");return{longDate:t,shortDate:t.slice(0,8)}},ws=({credentials:e,signingDate:t=new Date,signingRegion:n,signingService:r,uriEscapePath:o=!0})=>{const{accessKeyId:i,secretAccessKey:s,sessionToken:c}=e,{longDate:a,shortDate:u}=bs(t),d=Ss(u,n,r);return{accessKeyId:i,credentialScope:d,longDate:a,secretAccessKey:s,sessionToken:c,shortDate:u,signingRegion:n,signingService:r,uriEscapePath:o}},ne=(e,t)=>{const n=new To(e??void 0);return n.update(t),n.digestSync()},Ze=(e,t)=>{const n=ne(e,t);return ko(n)},vs=e=>Object.entries(e).map(([t,n])=>({key:t.toLowerCase(),value:n?.trim().replace(/\s+/g," ")??""})).sort((t,n)=>t.key<n.key?-1:1).map(t=>`${t.key}:${t.value}
`).join(""),Is=e=>Array.from(e).sort(([t,n],[r,o])=>t===r?n<o?-1:1:t<r?-1:1).map(([t,n])=>`${rn(t)}=${rn(n)}`).join("&"),rn=e=>encodeURIComponent(e).replace(/[!'()*]/g,Es),Es=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`,_s=(e,t=!0)=>e?t?encodeURIComponent(e).replace(/%2F/g,"/"):e:"/",As=e=>e==null?ys:Cs(e)?Ze(null,e):ms,Cs=e=>typeof e=="string"||ArrayBuffer.isView(e)||Ts(e),Ts=e=>typeof ArrayBuffer=="function"&&e instanceof ArrayBuffer||Object.prototype.toString.call(e)==="[object ArrayBuffer]",Os=({body:e,headers:t,method:n,url:r},o=!0)=>[n,_s(r.pathname,o),Is(r.searchParams),vs(t),dr(t),As(e)].join(`
`),ks=(e,t,n,r)=>{const o=`${ps}${e}`,i=ne(o,t),s=ne(i,n),c=ne(s,r);return ne(c,lr)},Ns=(e,t,n)=>[fr,e,t,n].join(`
`),Rs=(e,{credentialScope:t,longDate:n,secretAccessKey:r,shortDate:o,signingRegion:i,signingService:s,uriEscapePath:c})=>{const a=Os(e,c),u=Ze(null,a),d=Ns(n,t,u);return Ze(ks(r,o,i,s),d)},hr=(e,t)=>{const n=ws(t),{accessKeyId:r,credentialScope:o,longDate:i,sessionToken:s}=n,c={...e.headers};c[fs]=e.url.host,c[hs]=i,s&&(c[gs]=s);const a={...e,headers:c},u=Rs(a,n),d=`Credential=${r}/${o}`,l=`SignedHeaders=${dr(c)}`,h=`Signature=${u}`;return c[ls]=`${fr} ${d}, ${l}, ${h}`,a},gr=e=>new Date(Date.now()+e),Ps=5*60*1e3,xs=(e,t)=>Math.abs(gr(t).getTime()-e)>=Ps,Ds=(e,t)=>xs(e,t)?e-Date.now():t,Ls=({credentials:e,region:t,service:n,uriEscapePath:r=!0})=>{let o;return i=>async function(c){o=o??0;const a={credentials:typeof e=="function"?await e():e,signingDate:gr(o),signingRegion:t,signingService:n,uriEscapePath:r},u=await hr(c,a),d=await i(u),l=Ms(d);return l&&(o=Ds(Date.parse(l),o)),d}},Ms=({headers:e}={})=>e?.date??e?.Date??e?.["x-amz-date"],Us=Ve(er,[Zn,Xn,Ls]);class Ks extends Error{constructor(){super(...arguments),this.nonRetryable=!0}}const $s=(e,t,n=tr,r)=>jr(e,t,nr(n)),Vs=e=>{let t;return async(...n)=>t||(t=new Promise((r,o)=>{e(...n).then(i=>{r(i)}).catch(i=>{o(i)}).finally(()=>{t=void 0})}),t)};class Pe extends N{get response(){return this._response?Ws(this._response):void 0}constructor(t){super(t),this.constructor=Pe,Object.setPrototypeOf(this,Pe.prototype),t.response&&(this._response=t.response)}}const Ws=e=>({...e,headers:{...e.headers}});function Fs(e){return Array.from(e,t=>String.fromCodePoint(t)).join("")}const Hs={convert(e,t={urlSafe:!1,skipPadding:!1}){const n=typeof e=="string"?e:Fs(e);let r=Wr()(n);return t.urlSafe&&(r=r.replace(/\+/g,"-").replace(/\//g,"_")),t.skipPadding&&(r=r.replace(/=/g,"")),r}};class y extends N{constructor(t){super(t),this.constructor=y,Object.setPrototypeOf(this,y.prototype)}}function Gs(e){const t=e?.split("_")[0];if(!e||e.indexOf("_")<0||!t||typeof t!="string")throw new y({name:"InvalidUserPoolId",message:"Invalid user pool id provided."});return t}function et(e){if(!e||!e.includes(":"))throw new y({name:"InvalidIdentityPoolIdException",message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."});return e.split(":")[0]}const pr="UserUnAuthenticatedException",js="InvalidRedirectException",qs="InvalidAppSchemeException",Bs="InvalidPreferredRedirectUrlException";new y({name:js,message:"signInRedirect or signOutRedirect had an invalid format or was not found.",recoverySuggestion:"Please make sure the signIn/Out redirect in your oauth config is valid."});new y({name:qs,message:"A valid non-http app scheme was not found in the config.",recoverySuggestion:"Please make sure a valid custom app scheme is present in the config."});new y({name:Bs,message:"The given preferredRedirectUrl does not match any items in the redirectSignOutUrls array from the config.",recoverySuggestion:"Please make sure a matching preferredRedirectUrl is provided."});const zs="InvalidOriginException";new y({name:zs,message:"redirect is coming from a different origin. The oauth flow needs to be initiated from the same origin",recoverySuggestion:"Please call signInWithRedirect from the same origin."});const Js="TokenRefreshException";function Qs(e){if(!e||!e.idToken)throw new y({name:pr,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}const Ys=new y({name:Js,message:`Token refresh is not supported when authenticated with the 'implicit grant' (token) oauth flow. 
	Please change your oauth configuration to use 'code grant' flow.`,recoverySuggestion:`Please logout and change your Amplify configuration to use "code grant" flow. 
	E.g { responseType: 'code' }`}),Xs=new y({name:pr,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."});function Zs(e){if(na(e))throw Ys;if(!ta(e))throw Xs}const ea={inflightOAuth:"inflightOAuth",oauthSignIn:"oauthSignIn",oauthPKCE:"oauthPKCE",oauthState:"oauthState"};function yr(e){return e?.accessToken||e?.idToken}function ta(e){return yr(e)&&e?.refreshToken}function na(e){return yr(e)&&!e?.refreshToken}const ra=e=>(t,n)=>{const r=oa(e),o=JSON.stringify(t);return ia(n,r,o)},oa=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityProviderService.${e}`}),ia=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"});function mr(e){if(!e||e.name==="Error"||e instanceof TypeError)throw new y({name:j.Unknown,message:"An unknown error has occurred.",underlyingError:e})}const sa=()=>async e=>{if(e.statusCode>=300){const t=await ee(e);throw mr(t),new y({name:t.name,message:t.message})}return $e(e)},aa=()=>(e,t)=>async function(r){return r.headers["cache-control"]="no-store",e(r)},ca=Ve(gt,[aa]),Sr="cognito-idp",ua={service:Sr,retryDecider:yt(ee),computeDelay:pt,userAgentValue:ge(),cache:"no-store"},da=e=>ht(ca,ra("InitiateAuth"),sa(),{...ua,...e}),la=({region:e})=>({url:new F(`https://${Sr}.${e}.${Yn(e)}`)}),fa=({endpointOverride:e})=>t=>e?{url:new F(e)}:la(t);function ha({username:e,userPoolId:t,userPoolClientId:n}){if(typeof window>"u")return;const r=window.AmazonCognitoAdvancedSecurityData;if(typeof r>"u")return;const o=r.getData(e,t,n);return o?{EncodedData:o}:{}}const ga=async({tokens:e,authConfig:t,username:n})=>{T(t?.Cognito);const{userPoolId:r,userPoolClientId:o,userPoolEndpoint:i}=t.Cognito,s=Gs(r);Zs(e);const c=e.refreshToken,a={REFRESH_TOKEN:c};e.deviceMetadata?.deviceKey&&(a.DEVICE_KEY=e.deviceMetadata.deviceKey);const u=ha({username:n,userPoolId:r,userPoolClientId:o}),d=da({endpointResolver:fa({endpointOverride:i})}),{AuthenticationResult:l}=await d({region:s},{ClientId:o,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:a,UserContextData:u}),h=ae(l?.AccessToken??""),f=l?.IdToken?ae(l.IdToken):void 0,{iat:p}=h.payload;if(!p)throw new y({name:"iatNotFoundException",message:"iat not found in access token"});const g=p*1e3-new Date().getTime();return{accessToken:h,idToken:f,clockDrift:g,refreshToken:c,username:n}},pa=Vs(ga),ya={accessToken:"accessToken",idToken:"idToken",oidcProvider:"oidcProvider",clockDrift:"clockDrift",refreshToken:"refreshToken",deviceKey:"deviceKey",randomPasswordKey:"randomPasswordKey",deviceGroupKey:"deviceGroupKey",signInDetails:"signInDetails",oauthMetadata:"oauthMetadata"};var xe;(function(e){e.InvalidAuthTokens="InvalidAuthTokens"})(xe||(xe={}));const ma={[xe.InvalidAuthTokens]:{message:"Invalid tokens.",recoverySuggestion:"Make sure the tokens are valid."}},Sa=En(ma);class ba{constructor(){this.name="CognitoIdentityServiceProvider"}getKeyValueStorage(){if(!this.keyValueStorage)throw new y({name:"KeyValueStorageNotFoundException",message:"KeyValueStorage was not found in TokenStore"});return this.keyValueStorage}setKeyValueStorage(t){this.keyValueStorage=t}setAuthConfig(t){this.authConfig=t}async loadTokens(){try{const t=await this.getAuthKeys(),n=await this.getKeyValueStorage().getItem(t.accessToken);if(!n)throw new y({name:"NoSessionFoundException",message:"Auth session was not found. Make sure to call signIn."});const r=ae(n),o=await this.getKeyValueStorage().getItem(t.idToken),i=o?ae(o):void 0,s=await this.getKeyValueStorage().getItem(t.refreshToken)??void 0,c=await this.getKeyValueStorage().getItem(t.clockDrift)??"0",a=Number.parseInt(c),u=await this.getKeyValueStorage().getItem(t.signInDetails),d={accessToken:r,idToken:i,refreshToken:s,deviceMetadata:await this.getDeviceMetadata()??void 0,clockDrift:a,username:await this.getLastAuthUser()};return u&&(d.signInDetails=JSON.parse(u)),d}catch{return null}}async storeTokens(t){Sa(t!==void 0,xe.InvalidAuthTokens),await this.clearTokens();const n=t.username;await this.getKeyValueStorage().setItem(this.getLastAuthUserKey(),n);const r=await this.getAuthKeys();await this.getKeyValueStorage().setItem(r.accessToken,t.accessToken.toString()),t.idToken&&await this.getKeyValueStorage().setItem(r.idToken,t.idToken.toString()),t.refreshToken&&await this.getKeyValueStorage().setItem(r.refreshToken,t.refreshToken),t.deviceMetadata&&(t.deviceMetadata.deviceKey&&await this.getKeyValueStorage().setItem(r.deviceKey,t.deviceMetadata.deviceKey),t.deviceMetadata.deviceGroupKey&&await this.getKeyValueStorage().setItem(r.deviceGroupKey,t.deviceMetadata.deviceGroupKey),await this.getKeyValueStorage().setItem(r.randomPasswordKey,t.deviceMetadata.randomPassword)),t.signInDetails&&await this.getKeyValueStorage().setItem(r.signInDetails,JSON.stringify(t.signInDetails)),await this.getKeyValueStorage().setItem(r.clockDrift,`${t.clockDrift}`)}async clearTokens(){const t=await this.getAuthKeys();await Promise.all([this.getKeyValueStorage().removeItem(t.accessToken),this.getKeyValueStorage().removeItem(t.idToken),this.getKeyValueStorage().removeItem(t.clockDrift),this.getKeyValueStorage().removeItem(t.refreshToken),this.getKeyValueStorage().removeItem(t.signInDetails),this.getKeyValueStorage().removeItem(this.getLastAuthUserKey()),this.getKeyValueStorage().removeItem(t.oauthMetadata)])}async getDeviceMetadata(t){const n=await this.getAuthKeys(t),r=await this.getKeyValueStorage().getItem(n.deviceKey),o=await this.getKeyValueStorage().getItem(n.deviceGroupKey),i=await this.getKeyValueStorage().getItem(n.randomPasswordKey);return i&&o&&r?{deviceKey:r,deviceGroupKey:o,randomPassword:i}:null}async clearDeviceMetadata(t){const n=await this.getAuthKeys(t);await Promise.all([this.getKeyValueStorage().removeItem(n.deviceKey),this.getKeyValueStorage().removeItem(n.deviceGroupKey),this.getKeyValueStorage().removeItem(n.randomPasswordKey)])}async getAuthKeys(t){T(this.authConfig?.Cognito);const n=t??await this.getLastAuthUser();return wa(this.name,`${this.authConfig.Cognito.userPoolClientId}.${n}`)}getLastAuthUserKey(){T(this.authConfig?.Cognito);const t=this.authConfig.Cognito.userPoolClientId;return`${this.name}.${t}.LastAuthUser`}async getLastAuthUser(){return await this.getKeyValueStorage().getItem(this.getLastAuthUserKey())??"username"}async setOAuthMetadata(t){const{oauthMetadata:n}=await this.getAuthKeys();await this.getKeyValueStorage().setItem(n,JSON.stringify(t))}async getOAuthMetadata(){const{oauthMetadata:t}=await this.getAuthKeys(),n=await this.getKeyValueStorage().getItem(t);return n&&JSON.parse(n)}}const wa=(e,t)=>St(ya)(`${e}`,t);function St(e){const t=Object.values({...e});return(n,r)=>t.reduce((o,i)=>({...o,[i]:`${n}.${r}.${i}`}),{})}const on="amplify-signin-with-hostedUI",M="CognitoIdentityServiceProvider";class va{constructor(t){this.keyValueStorage=t}async clearOAuthInflightData(){T(this.cognitoConfig);const t=U(M,this.cognitoConfig.userPoolClientId);await Promise.all([this.keyValueStorage.removeItem(t.inflightOAuth),this.keyValueStorage.removeItem(t.oauthPKCE),this.keyValueStorage.removeItem(t.oauthState)])}async clearOAuthData(){T(this.cognitoConfig);const t=U(M,this.cognitoConfig.userPoolClientId);return await this.clearOAuthInflightData(),await this.keyValueStorage.removeItem(on),this.keyValueStorage.removeItem(t.oauthSignIn)}loadOAuthState(){T(this.cognitoConfig);const t=U(M,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthState)}storeOAuthState(t){T(this.cognitoConfig);const n=U(M,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(n.oauthState,t)}loadPKCE(){T(this.cognitoConfig);const t=U(M,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthPKCE)}storePKCE(t){T(this.cognitoConfig);const n=U(M,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(n.oauthPKCE,t)}setAuthConfig(t){this.cognitoConfig=t}async loadOAuthInFlight(){T(this.cognitoConfig);const t=U(M,this.cognitoConfig.userPoolClientId);return await this.keyValueStorage.getItem(t.inflightOAuth)==="true"}async storeOAuthInFlight(t){T(this.cognitoConfig);const n=U(M,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(n.inflightOAuth,`${t}`)}async loadOAuthSignIn(){T(this.cognitoConfig);const t=U(M,this.cognitoConfig.userPoolClientId),n=await this.keyValueStorage.getItem(on),[r,o]=(await this.keyValueStorage.getItem(t.oauthSignIn))?.split(",")??[];return{isOAuthSignIn:r==="true"||n==="true",preferPrivateSession:o==="true"}}async storeOAuthSignIn(t,n=!1){T(this.cognitoConfig);const r=U(M,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(r.oauthSignIn,`${t},${n}`)}}const U=(e,t)=>St(ea)(e,t),sn=new va(de);class Ia{constructor(){this.waitForInflightOAuth=Di()?async()=>{if(await sn.loadOAuthInFlight())return this.inflightPromise?this.inflightPromise:(this.inflightPromise=new Promise((t,n)=>{}),this.inflightPromise)}:async()=>{}}setAuthConfig(t){sn.setAuthConfig(t.Cognito),this.authConfig=t}setTokenRefresher(t){this.tokenRefresher=t}setAuthTokenStore(t){this.tokenStore=t}getTokenStore(){if(!this.tokenStore)throw new y({name:"EmptyTokenStoreException",message:"TokenStore not set"});return this.tokenStore}getTokenRefresher(){if(!this.tokenRefresher)throw new y({name:"EmptyTokenRefresherException",message:"TokenRefresher not set"});return this.tokenRefresher}async getTokens(t){let n;try{T(this.authConfig?.Cognito)}catch{return null}await this.waitForInflightOAuth(),this.inflightPromise=void 0,n=await this.getTokenStore().loadTokens();const r=await this.getTokenStore().getLastAuthUser();if(n===null)return null;const o=!!n?.idToken&&Nt({expiresAt:(n.idToken?.payload?.exp??0)*1e3,clockDrift:n.clockDrift??0}),i=Nt({expiresAt:(n.accessToken?.payload?.exp??0)*1e3,clockDrift:n.clockDrift??0});return(t?.forceRefresh||o||i)&&(n=await this.refreshTokens({tokens:n,username:r}),n===null)?null:{accessToken:n?.accessToken,idToken:n?.idToken,signInDetails:n?.signInDetails}}async refreshTokens({tokens:t,username:n}){try{const{signInDetails:r}=t,o=await this.getTokenRefresher()({tokens:t,authConfig:this.authConfig,username:n});return o.signInDetails=r,await this.setTokens({tokens:o}),Ne.dispatch("auth",{event:"tokenRefresh"},"Auth",se),o}catch(r){return this.handleErrors(r)}}handleErrors(t){if(mr(t),t.name!==j.NetworkError&&this.clearTokens(),Ne.dispatch("auth",{event:"tokenRefresh_failure",data:{error:t}},"Auth",se),t.name.startsWith("NotAuthorizedException"))return null;throw t}async setTokens({tokens:t}){return this.getTokenStore().storeTokens(t)}async clearTokens(){return this.getTokenStore().clearTokens()}getDeviceMetadata(t){return this.getTokenStore().getDeviceMetadata(t)}clearDeviceMetadata(t){return this.getTokenStore().clearDeviceMetadata(t)}setOAuthMetadata(t){return this.getTokenStore().setOAuthMetadata(t)}getOAuthMetadata(){return this.getTokenStore().getOAuthMetadata()}}class Ea{constructor(){this.authTokenStore=new ba,this.authTokenStore.setKeyValueStorage(de),this.tokenOrchestrator=new Ia,this.tokenOrchestrator.setAuthTokenStore(this.authTokenStore),this.tokenOrchestrator.setTokenRefresher(pa)}getTokens({forceRefresh:t}={forceRefresh:!1}){return this.tokenOrchestrator.getTokens({forceRefresh:t})}setKeyValueStorage(t){this.authTokenStore.setKeyValueStorage(t)}setAuthConfig(t){this.authTokenStore.setAuthConfig(t),this.tokenOrchestrator.setAuthConfig(t)}}const re=new Ea,{tokenOrchestrator:qc}=re,_a={identityId:"identityId"},Aa=new _("DefaultIdentityIdStore");class Ca{setAuthConfig(t){Ee(t.Cognito),this.authConfig=t,this._authKeys=Ta("Cognito",t.Cognito.identityPoolId)}constructor(t){this._authKeys={},this._hasGuestIdentityId=!1,this.keyValueStorage=t}async loadIdentityId(){Ee(this.authConfig?.Cognito);try{if(this._primaryIdentityId)return{id:this._primaryIdentityId,type:"primary"};{const t=await this.keyValueStorage.getItem(this._authKeys.identityId);return t?(this._hasGuestIdentityId=!0,{id:t,type:"guest"}):null}}catch(t){return Aa.log("Error getting stored IdentityId.",t),null}}async storeIdentityId(t){Ee(this.authConfig?.Cognito),t.type==="guest"?(this.keyValueStorage.setItem(this._authKeys.identityId,t.id),this._primaryIdentityId=void 0,this._hasGuestIdentityId=!0):(this._primaryIdentityId=t.id,this._hasGuestIdentityId&&(this.keyValueStorage.removeItem(this._authKeys.identityId),this._hasGuestIdentityId=!1))}async clearIdentityId(){this._primaryIdentityId=void 0,await this.keyValueStorage.removeItem(this._authKeys.identityId)}}const Ta=(e,t)=>St(_a)(`com.amplify.${e}`,t);function br(e){const t=ae(e).payload.iss,n={};if(!t)throw new y({name:"InvalidIdTokenException",message:"Invalid Idtoken."});const r=t.replace(/(^\w+:|^)\/\//,"");return n[r]=e,n}const Oa=new _("CognitoIdentityIdProvider");async function ka({tokens:e,authConfig:t,identityIdStore:n}){n.setAuthConfig({Cognito:t});let r=await n.loadIdentityId();if(e){if(r&&r.type==="primary")return r.id;{const o=e.idToken?br(e.idToken.toString()):{},i=await an(o,t);r&&r.id===i&&Oa.debug(`The guest identity ${r.id} has become the primary identity.`),r={id:i,type:"primary"}}}else{if(r&&r.type==="guest")return r.id;r={id:await an({},t),type:"guest"}}return n.storeIdentityId(r),r.id}async function an(e,t){const n=t?.identityPoolId,r=et(n),o=(await es({region:r},{IdentityPoolId:n,Logins:e})).IdentityId;if(!o)throw new y({name:"GetIdResponseException",message:"Received undefined response from getId operation",recoverySuggestion:"Make sure to pass a valid identityPoolId in the configuration."});return o}const Ie=new _("CognitoCredentialsProvider"),cn=50*60*1e3;class Na{constructor(t){this._nextCredentialsRefresh=0,this._identityIdStore=t}async clearCredentialsAndIdentityId(){Ie.debug("Clearing out credentials and identityId"),this._credentialsAndIdentityId=void 0,await this._identityIdStore.clearIdentityId()}async clearCredentials(){Ie.debug("Clearing out in-memory credentials"),this._credentialsAndIdentityId=void 0}async getCredentialsAndIdentityId(t){const n=t.authenticated,{tokens:r}=t,{authConfig:o}=t;try{Ee(o?.Cognito)}catch{return}if(!n&&!o.Cognito.allowGuestAccess)return;const{forceRefresh:i}=t,s=this.hasTokenChanged(r),c=await ka({tokens:r,authConfig:o.Cognito,identityIdStore:this._identityIdStore});return(i||s)&&this.clearCredentials(),n?(Qs(r),this.credsForOIDCTokens(o.Cognito,r,c)):this.getGuestCredentials(c,o.Cognito)}async getGuestCredentials(t,n){if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!1)return Ie.info("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const r=et(n.identityPoolId),o=await en({region:r},{IdentityId:t});if(o.Credentials&&o.Credentials.AccessKeyId&&o.Credentials.SecretKey){this._nextCredentialsRefresh=new Date().getTime()+cn;const i={credentials:{accessKeyId:o.Credentials.AccessKeyId,secretAccessKey:o.Credentials.SecretKey,sessionToken:o.Credentials.SessionToken,expiration:o.Credentials.Expiration},identityId:t},s=o.IdentityId;return s&&(i.identityId=s,this._identityIdStore.storeIdentityId({id:s,type:"guest"})),this._credentialsAndIdentityId={...i,isAuthenticatedCreds:!1},i}else throw new y({name:"CredentialsNotFoundException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}async credsForOIDCTokens(t,n,r){if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!0)return Ie.debug("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const o=n.idToken?br(n.idToken.toString()):{},i=et(t.identityPoolId),s=await en({region:i},{IdentityId:r,Logins:o});if(s.Credentials&&s.Credentials.AccessKeyId&&s.Credentials.SecretKey){const c={credentials:{accessKeyId:s.Credentials.AccessKeyId,secretAccessKey:s.Credentials.SecretKey,sessionToken:s.Credentials.SessionToken,expiration:s.Credentials.Expiration},identityId:r};this._credentialsAndIdentityId={...c,isAuthenticatedCreds:!0,associatedIdToken:n.idToken?.toString()},this._nextCredentialsRefresh=new Date().getTime()+cn;const a=s.IdentityId;return a&&(c.identityId=a,this._identityIdStore.storeIdentityId({id:a,type:"primary"})),c}else throw new y({name:"CredentialsException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}isPastTTL(){return this._nextCredentialsRefresh===void 0?!0:this._nextCredentialsRefresh<=Date.now()}hasTokenChanged(t){return!!t&&!!this._credentialsAndIdentityId?.associatedIdToken&&t.idToken?.toString()!==this._credentialsAndIdentityId.associatedIdToken}}const Ra=new Na(new Ca(de)),Pa={configure(e,t){const n=On(e);if(!n.Auth){L.configure(n,t);return}if(t?.Auth){L.configure(n,t);return}if(!L.libraryOptions.Auth){re.setAuthConfig(n.Auth),re.setKeyValueStorage(t?.ssr?new tn({sameSite:"lax"}):de),L.configure(n,{...t,Auth:{tokenProvider:re,credentialsProvider:Ra}});return}if(t){t.ssr!==void 0&&re.setKeyValueStorage(t.ssr?new tn({sameSite:"lax"}):de),L.configure(n,{Auth:L.libraryOptions.Auth,...t});return}L.configure(n)},getConfig(){return L.getConfig()}};function Ce(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ce=function(n){return typeof n}:Ce=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ce(e)}function xa(e){return Ce(e)=="object"&&e!==null}var Da=typeof Symbol=="function"&&Symbol.toStringTag!=null?Symbol.toStringTag:"@@toStringTag";function tt(e,t){for(var n=/\r\n|[\n\r]/g,r=1,o=t+1,i;(i=n.exec(e.body))&&i.index<t;)r+=1,o=t+1-(i.index+i[0].length);return{line:r,column:o}}function La(e){return wr(e.source,tt(e.source,e.start))}function wr(e,t){var n=e.locationOffset.column-1,r=Te(n)+e.body,o=t.line-1,i=e.locationOffset.line-1,s=t.line+i,c=t.line===1?n:0,a=t.column+c,u="".concat(e.name,":").concat(s,":").concat(a,`
`),d=r.split(/\r\n|[\n\r]/g),l=d[o];if(l.length>120){for(var h=Math.floor(a/80),f=a%80,p=[],g=0;g<l.length;g+=80)p.push(l.slice(g,g+80));return u+un([["".concat(s),p[0]]].concat(p.slice(1,h+1).map(function(A){return["",A]}),[[" ",Te(f-1)+"^"],["",p[h+1]]]))}return u+un([["".concat(s-1),d[o-1]],["".concat(s),l],["",Te(a-1)+"^"],["".concat(s+1),d[o+1]]])}function un(e){var t=e.filter(function(r){r[0];var o=r[1];return o!==void 0}),n=Math.max.apply(Math,t.map(function(r){var o=r[0];return o.length}));return t.map(function(r){var o=r[0],i=r[1];return Ma(n,o)+(i?" | "+i:" |")}).join(`
`)}function Te(e){return Array(e+1).join(" ")}function Ma(e,t){return Te(e-t.length)+t}function Oe(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Oe=function(n){return typeof n}:Oe=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Oe(e)}function dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Ua(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?dn(Object(n),!0).forEach(function(r){Ka(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dn(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Ka(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Va(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wa(e,t,n){return t&&Va(e.prototype,t),e}function Fa(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}function Ha(e){var t=Ir();return function(){var r=fe(e),o;if(t){var i=fe(this).constructor;o=Reflect.construct(r,arguments,i)}else o=r.apply(this,arguments);return vr(this,o)}}function vr(e,t){return t&&(Oe(t)==="object"||typeof t=="function")?t:oe(e)}function oe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nt(e){var t=typeof Map=="function"?new Map:void 0;return nt=function(r){if(r===null||!Ga(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(r))return t.get(r);t.set(r,o)}function o(){return ke(r,arguments,fe(this).constructor)}return o.prototype=Object.create(r.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),le(o,r)},nt(e)}function ke(e,t,n){return Ir()?ke=Reflect.construct:ke=function(o,i,s){var c=[null];c.push.apply(c,i);var a=Function.bind.apply(o,c),u=new a;return s&&le(u,s.prototype),u},ke.apply(null,arguments)}function Ir(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Ga(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function le(e,t){return le=Object.setPrototypeOf||function(r,o){return r.__proto__=o,r},le(e,t)}function fe(e){return fe=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},fe(e)}var qe=function(e){Fa(n,e);var t=Ha(n);function n(r,o,i,s,c,a,u){var d,l,h,f;$a(this,n),f=t.call(this,r),f.name="GraphQLError",f.originalError=a??void 0,f.nodes=ln(Array.isArray(o)?o:o?[o]:void 0);for(var p=[],g=0,A=(P=f.nodes)!==null&&P!==void 0?P:[];g<A.length;g++){var P,B=A[g],z=B.loc;z!=null&&p.push(z)}p=ln(p),f.source=i??((d=p)===null||d===void 0?void 0:d[0].source),f.positions=s??((l=p)===null||l===void 0?void 0:l.map(function(K){return K.start})),f.locations=s&&i?s.map(function(K){return tt(i,K)}):(h=p)===null||h===void 0?void 0:h.map(function(K){return tt(K.source,K.start)}),f.path=c??void 0;var pe=a?.extensions;return u==null&&xa(pe)?f.extensions=Ua({},pe):f.extensions=u??{},Object.defineProperties(oe(f),{message:{enumerable:!0},locations:{enumerable:f.locations!=null},path:{enumerable:f.path!=null},extensions:{enumerable:f.extensions!=null&&Object.keys(f.extensions).length>0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),a!=null&&a.stack?(Object.defineProperty(oe(f),"stack",{value:a.stack,writable:!0,configurable:!0}),vr(f)):(Error.captureStackTrace?Error.captureStackTrace(oe(f),n):Object.defineProperty(oe(f),"stack",{value:Error().stack,writable:!0,configurable:!0}),f)}return Wa(n,[{key:"toString",value:function(){return ja(this)}},{key:Da,get:function(){return"Object"}}]),n}(nt(Error));function ln(e){return e===void 0||e.length===0?void 0:e}function ja(e){var t=e.message;if(e.nodes)for(var n=0,r=e.nodes;n<r.length;n++){var o=r[n];o.loc&&(t+=`

`+La(o.loc))}else if(e.source&&e.locations)for(var i=0,s=e.locations;i<s.length;i++){var c=s[i];t+=`

`+wr(e.source,c)}return t}class he extends Pe{constructor(t){super(t),this.constructor=he,Object.setPrototypeOf(this,he.prototype)}}class De extends he{constructor(t={}){super({name:"CanceledError",message:"Request is canceled by user",...t}),this.constructor=De,Object.setPrototypeOf(this,De.prototype)}}var rt;(function(e){e.InvalidApiName="InvalidApiName"})(rt||(rt={}));rt.InvalidApiName+"";const Er=async e=>{if(!e)return;const t=await ee(qa(e));if(t){const n=await e.body?.text();return Ba(t,{statusCode:e.statusCode,headers:e.headers,body:n})}},qa=e=>{let t;const n=new Proxy(e.body,{get(o,i,s){return i==="json"?async()=>{t||(t=o.text());try{return JSON.parse(await t)}catch{return{}}}:i==="text"?async()=>(t||(t=o.text()),t):Reflect.get(o,i,s)}});return new Proxy(e,{get(o,i,s){return i==="body"?n:Reflect.get(o,i,s)}})},Ba=(e,t)=>{const n=new he({name:e?.name,message:e.message,underlyingError:e,response:t});return Object.assign(n,{$metadata:e.$metadata})},ot=new _("RestApis");function za(e,t){const n=a=>!!t,r=new AbortController,o=r.signal,i=t?.signal;let s;const c=async()=>{try{const a=await(n(e)?e():e(o));if(a.statusCode>=300)throw await Er(a);return a}catch(a){const u=i??o,d=s??u.reason;if(a.name==="AbortError"||u?.aborted===!0){const l=new De({...d&&{message:d},underlyingError:a,recoverySuggestion:"The API request was explicitly canceled. If this is not intended, validate if you called the `cancel()` function on the API request erroneously."});throw ot.debug(a),l}throw ot.debug(a),a}};if(n())return c();{const a=u=>{o.aborted!==!0&&(r.abort(u),u&&o.reason!==u&&(s=u))};return{response:c(),cancel:a}}}const fn="execute-api",Ja="us-east-1",Qa=/^.+\.([a-z0-9-]+)\.([a-z0-9-]+)\.amazonaws\.com/,Ya=(e,t)=>{const{service:n=fn,region:r=Ja}={},{hostname:o}=e,[,i,s]=Qa.exec(o)??[];return i===fn?{service:i,region:s??r}:i==="appsync-api"?{service:"appsync",region:s??r}:{service:n,region:r}},Xa=({headers:e},t)=>!e.authorization&&!e["x-api-key"]&&!!t,Za=(e,t)=>{const n={};for(const r in e)n[r.toLowerCase()]=e[r];return t&&(n["content-type"]="application/json; charset=UTF-8",t instanceof FormData&&delete n["content-type"]),n},ec=async(e,t,n,r)=>{const{url:o,method:i,headers:s,body:c,withCredentials:a,abortSignal:u}=t,d=c?c instanceof FormData?c:JSON.stringify(c??""):void 0,l=Za(s,c),h={url:o,headers:l,method:i,body:d},f={retryDecider:yt(Er),computeDelay:pt,withCrossDomainCredentials:a,abortSignal:u},p=n(h,r);let g;const A=await tc(e);if(p&&A){const P=Ya(o),B=r?.service??P.service,z=r?.region??P.region;g=await Us(h,{...f,credentials:A,region:z,service:B})}else g=await gt(h,{...f});return{statusCode:g.statusCode,headers:g.headers,body:g.body}},tc=async e=>{try{const{credentials:t}=await e.Auth.fetchAuthSession();if(t)return t}catch{ot.debug("No credentials available, the request will be unsigned.")}return null},nc=new WeakMap,rc=(e,{url:t,options:n,abortController:r})=>{const o=r??new AbortController,s=za(async()=>ec(e,{url:t,method:"POST",...n,abortSignal:o.signal},Xa,n?.signingServiceInfo),o).finally(()=>{nc.delete(s)});return s},oc=5e3,ic=[400,401,403],sc=["BadRequestException","UnauthorizedException"],ac="ConnectionStateChange";var k;(function(e){e.GQL_CONNECTION_INIT="connection_init",e.GQL_CONNECTION_ERROR="connection_error",e.GQL_CONNECTION_ACK="connection_ack",e.GQL_START="start",e.GQL_START_ACK="start_ack",e.DATA="data",e.GQL_CONNECTION_KEEP_ALIVE="ka",e.GQL_STOP="stop",e.GQL_COMPLETE="complete",e.GQL_ERROR="error",e.EVENT_SUBSCRIBE="subscribe",e.EVENT_PUBLISH="publish",e.EVENT_SUBSCRIBE_ACK="subscribe_success",e.EVENT_PUBLISH_ACK="publish_success",e.EVENT_STOP="unsubscribe",e.EVENT_COMPLETE="unsubscribe_success"})(k||(k={}));var $;(function(e){e[e.PENDING=0]="PENDING",e[e.CONNECTED=1]="CONNECTED",e[e.FAILED=2]="FAILED"})($||($={}));var C;(function(e){e[e.CLOSED=0]="CLOSED",e[e.READY=1]="READY",e[e.CONNECTING=2]="CONNECTING"})(C||(C={}));const cc={accept:"application/json, text/javascript","content-encoding":"amz-1.0","content-type":"application/json; charset=UTF-8"},hn=15e3,uc=15e3,_r=5*60*1e3,dc=65*1e3,lc=5*1e3,fc=60*1e3;var D;(function(e){e.CONNECTION_CLOSED="Connection closed",e.CONNECTION_FAILED="Connection failed",e.REALTIME_SUBSCRIPTION_INIT_ERROR="AppSync Realtime subscription init error",e.SUBSCRIPTION_ACK="Subscription ack",e.TIMEOUT_DISCONNECT="Timeout disconnect"})(D||(D={}));var b;(function(e){e.Connected="Connected",e.ConnectedPendingNetwork="ConnectedPendingNetwork",e.ConnectionDisrupted="ConnectionDisrupted",e.ConnectionDisruptedPendingNetwork="ConnectionDisruptedPendingNetwork",e.Connecting="Connecting",e.ConnectedPendingDisconnect="ConnectedPendingDisconnect",e.Disconnected="Disconnected",e.ConnectedPendingKeepAlive="ConnectedPendingKeepAlive"})(b||(b={}));const gn=()=>new Y().networkMonitor(),E={KEEP_ALIVE_MISSED:{keepAliveState:"unhealthy"},KEEP_ALIVE:{keepAliveState:"healthy"},CONNECTION_ESTABLISHED:{connectionState:"connected"},CONNECTION_FAILED:{intendedConnectionState:"disconnected",connectionState:"disconnected"},CLOSING_CONNECTION:{intendedConnectionState:"disconnected"},OPENING_CONNECTION:{intendedConnectionState:"connected",connectionState:"connecting"},CLOSED:{connectionState:"disconnected"},ONLINE:{networkState:"connected"},OFFLINE:{networkState:"disconnected"}};class hc{constructor(){this._networkMonitoringSubscription=void 0,this._linkedConnectionState={networkState:"connected",connectionState:"disconnected",intendedConnectionState:"disconnected",keepAliveState:"healthy"},this._initialNetworkStateSubscription=gn().subscribe(({online:t})=>{this.record(t?E.ONLINE:E.OFFLINE),this._initialNetworkStateSubscription?.unsubscribe()}),this._linkedConnectionStateObservable=new R(t=>{t.next(this._linkedConnectionState),this._linkedConnectionStateObserver=t})}enableNetworkMonitoring(){this._initialNetworkStateSubscription?.unsubscribe(),this._networkMonitoringSubscription===void 0&&(this._networkMonitoringSubscription=gn().subscribe(({online:t})=>{this.record(t?E.ONLINE:E.OFFLINE)}))}disableNetworkMonitoring(){this._networkMonitoringSubscription?.unsubscribe(),this._networkMonitoringSubscription=void 0}get connectionStateObservable(){let t;return this._linkedConnectionStateObservable.pipe(Ri(n=>this.connectionStatesTranslator(n))).pipe(Pi(n=>{const r=n!==t;return t=n,r}))}record(t){t.intendedConnectionState==="connected"?this.enableNetworkMonitoring():t.intendedConnectionState==="disconnected"&&this.disableNetworkMonitoring();const n={...this._linkedConnectionState,...t};this._linkedConnectionState={...n},this._linkedConnectionStateObserver?.next(this._linkedConnectionState)}connectionStatesTranslator({connectionState:t,networkState:n,intendedConnectionState:r,keepAliveState:o}){return t==="connected"&&n==="disconnected"?b.ConnectedPendingNetwork:t==="connected"&&r==="disconnected"?b.ConnectedPendingDisconnect:t==="disconnected"&&r==="connected"&&n==="disconnected"?b.ConnectionDisruptedPendingNetwork:t==="disconnected"&&r==="connected"?b.ConnectionDisrupted:t==="connected"&&o==="unhealthy"?b.ConnectedPendingKeepAlive:t==="connecting"?b.Connecting:t==="disconnected"?b.Disconnected:b.Connected}}var X;(function(e){e.START_RECONNECT="START_RECONNECT",e.HALT_RECONNECT="HALT_RECONNECT"})(X||(X={}));class gc{constructor(){this.reconnectObservers=[]}addObserver(t){this.reconnectObservers.push(t)}record(t){t===X.START_RECONNECT&&this.reconnectSetTimeoutId===void 0&&this.reconnectIntervalId===void 0&&(this.reconnectSetTimeoutId=setTimeout(()=>{this._triggerReconnect(),this.reconnectIntervalId=setInterval(()=>{this._triggerReconnect()},fc)},lc)),t===X.HALT_RECONNECT&&(this.reconnectIntervalId&&(clearInterval(this.reconnectIntervalId),this.reconnectIntervalId=void 0),this.reconnectSetTimeoutId&&(clearTimeout(this.reconnectSetTimeoutId),this.reconnectSetTimeoutId=void 0))}close(){this.reconnectObservers.forEach(t=>{t.complete?.()})}_triggerReconnect(){this.reconnectObservers.forEach(t=>{t.next?.()})}}const pn="wss://",pc=/^https:\/\/\w{26}\.appsync-api\.\w{2}(?:(?:-\w{2,})+)-\d\.amazonaws.com(?:\.cn)?\/graphql$/i,yc=/^https:\/\/\w{26}\.\w+-api\.\w{2}(?:(?:-\w{2,})+)-\d\.amazonaws.com(?:\.cn)?\/event$/i,yn="/realtime",mc=e=>e.match(pc)===null,Sc=e=>e.match(yc)!==null,bc=e=>{let t=e??"";return Sc(t)?t=t.concat(yn).replace("ddpg-api","grt-gamma").replace("appsync-api","appsync-realtime-api"):mc(t)?t=t.concat(yn):t=t.replace("appsync-api","appsync-realtime-api").replace("gogi-beta","grt-beta").replace("ddpg-api","grt-gamma"),t=t.replace("https://",pn).replace("http://",pn),new F(t)},wc=e=>{if(!e)return{};if("Authorization"in e){const{Authorization:t,...n}=e;return n}return e},vc=e=>{const t=wc(e),n=new rr;return Object.entries(t).forEach(([r,o])=>{n.append(r,o)}),n},Ic=(e,t)=>{const n=bc(e),r=new rr(n.search);for(const[o,i]of t.entries())r.append(o,i);return n.search=r.toString(),n.toString()},Be=async e=>{const{appSyncGraphqlEndpoint:t,query:n,libraryConfigHeaders:r=()=>({}),additionalHeaders:o={},authToken:i}=e;let s={};const c=await r();return typeof o=="function"?s=await o({url:t||"",queryString:n||""}):s=o,i&&(s={...s,Authorization:i}),{additionalCustomHeaders:s,libraryConfigHeaders:c}},mn=new _("AWSAppSyncRealTimeProvider Auth"),Sn=async({host:e})=>({Authorization:(await Jn())?.tokens?.accessToken?.toString(),host:e}),Ec=async({apiKey:e,host:t})=>{const r=new Date().toISOString().replace(/[:-]|\.\d{3}/g,"");return{host:t,"x-amz-date":r,"x-api-key":e}},_c=async({payload:e,canonicalUri:t,appSyncGraphqlEndpoint:n,region:r})=>{const o={region:r,service:"appsync"},i=(await Jn()).credentials,s={url:`${n}${t}`,data:e,method:"POST",headers:{...cc}};return hr({headers:s.headers,method:s.method,url:new F(s.url),body:s.data},{credentials:i,signingRegion:o.region,signingService:o.service}).headers},bn=async({host:e,additionalCustomHeaders:t})=>{if(!t?.Authorization)throw new Error("No auth token specified");return{Authorization:t.Authorization,host:e}},Ar=async({apiKey:e,authenticationType:t,canonicalUri:n,appSyncGraphqlEndpoint:r,region:o,additionalCustomHeaders:i,payload:s})=>{const c={apiKey:Ec,iam:_c,oidc:Sn,userPool:Sn,lambda:bn,none:bn};if(!t||!c[t]){mn.debug(`Authentication type ${t} not supported`);return}else{const a=c[t],u=r?new F(r).host:void 0,d=t==="apiKey"?e:void 0;return mn.debug(`Authenticating with ${JSON.stringify(t)}`),await a({payload:s,canonicalUri:n,appSyncGraphqlEndpoint:r,apiKey:d,region:o,host:u,additionalCustomHeaders:i})}},wn=e=>{Ne.dispatch("api",e,"PubSub",se)};class Ac{constructor(t){this.subscriptionObserverMap=new Map,this.socketStatus=C.CLOSED,this.keepAliveTimeout=_r,this.promiseArray=[],this.connectionStateMonitor=new hc,this.reconnectionMonitor=new gc,this._establishConnection=async(n,r)=>{this.logger.debug(`Establishing WebSocket connection to ${n}`);try{await this._openConnection(n,r),await this._initiateHandshake()}catch(o){const{errorType:i,errorCode:s}=o;throw ic.includes(s)||sc.includes(i)?new Ks(i):i?new Error(i):o}},this.logger=new _(t.providerName),this.wsProtocolName=t.wsProtocolName,this.wsConnectUri=t.connectUri,this.connectionStateMonitorSubscription=this._startConnectionStateMonitoring()}close(){return this.socketStatus=C.CLOSED,this.connectionStateMonitor.record(E.CONNECTION_FAILED),this.connectionStateMonitorSubscription.unsubscribe(),this.reconnectionMonitor.close(),new Promise((t,n)=>{this.awsRealTimeSocket?(this.awsRealTimeSocket.onclose=r=>{this.subscriptionObserverMap=new Map,this.awsRealTimeSocket=void 0,t()},this.awsRealTimeSocket.onerror=r=>{n(r)},this.awsRealTimeSocket.close()):t()})}subscribe(t,n){return new R(r=>{if(!t?.appSyncGraphqlEndpoint){r.error({errors:[{...new qe("Subscribe only available for AWS AppSync endpoint")}]}),r.complete();return}let o=!1;const i=nn(),s=()=>{o||(o=!0,this._startSubscriptionWithAWSAppSyncRealTime({options:t,observer:r,subscriptionId:i,customUserAgentDetails:n}).catch(a=>{this.logger.debug(`${D.REALTIME_SUBSCRIPTION_INIT_ERROR}: ${a}`),this.connectionStateMonitor.record(E.CLOSED)}).finally(()=>{o=!1}))},c=new R(a=>{this.reconnectionMonitor.addObserver(a)}).subscribe(()=>{s()});return s(),async()=>{await this._cleanupSubscription(i,c)}})}async connect(t){this.socketStatus!==C.READY&&await this._connectWebSocket(t)}async publish(t,n){if(this.socketStatus!==C.READY)throw new Error("Subscription has not been initialized");return this._publishMessage(t,n)}async _connectWebSocket(t){const{apiKey:n,appSyncGraphqlEndpoint:r,authenticationType:o,region:i}=t,{additionalCustomHeaders:s}=await Be(t);this.connectionStateMonitor.record(E.OPENING_CONNECTION),await this._initializeWebSocketConnection({apiKey:n,appSyncGraphqlEndpoint:r,authenticationType:o,region:i,additionalCustomHeaders:s})}async _publishMessage(t,n){const r=nn(),{additionalCustomHeaders:o,libraryConfigHeaders:i}=await Be(t),s=await this._prepareSubscriptionPayload({options:t,subscriptionId:r,customUserAgentDetails:n,additionalCustomHeaders:o,libraryConfigHeaders:i,publish:!0});return new Promise((c,a)=>{if(this.awsRealTimeSocket){const u=d=>{const l=JSON.parse(d.data);l.id===r&&l.type==="publish_success"&&(this.awsRealTimeSocket&&this.awsRealTimeSocket.removeEventListener("message",u),c()),l.erroredEvents&&l.erroredEvents.length>0};this.awsRealTimeSocket.addEventListener("message",u),this.awsRealTimeSocket.addEventListener("close",()=>{a(new Error("WebSocket is closed"))}),this.awsRealTimeSocket.send(s)}})}async _cleanupSubscription(t,n){n?.unsubscribe();try{await this._waitForSubscriptionToBeConnected(t);const{subscriptionState:r}=this.subscriptionObserverMap.get(t)||{};if(!r)return;if(r===$.CONNECTED)this._sendUnsubscriptionMessage(t);else throw new Error("Subscription never connected")}catch(r){this.logger.debug(`Error while unsubscribing ${r}`)}finally{this._removeSubscriptionObserver(t)}}_startConnectionStateMonitoring(){return this.connectionStateMonitor.connectionStateObservable.subscribe(t=>{wn({event:ac,data:{provider:this,connectionState:t},message:`Connection state is ${t}`}),this.connectionState=t,t===b.ConnectionDisrupted&&this.reconnectionMonitor.record(X.START_RECONNECT),[b.Connected,b.ConnectedPendingDisconnect,b.ConnectedPendingKeepAlive,b.ConnectedPendingNetwork,b.ConnectionDisruptedPendingNetwork,b.Disconnected].includes(t)&&this.reconnectionMonitor.record(X.HALT_RECONNECT)})}async _startSubscriptionWithAWSAppSyncRealTime({options:t,observer:n,subscriptionId:r,customUserAgentDetails:o}){const{query:i,variables:s}=t,{additionalCustomHeaders:c,libraryConfigHeaders:a}=await Be(t);this.subscriptionObserverMap.set(r,{observer:n,query:i??"",variables:s??{},subscriptionState:$.PENDING,startAckTimeoutId:void 0});const u=await this._prepareSubscriptionPayload({options:t,subscriptionId:r,customUserAgentDetails:o,additionalCustomHeaders:c,libraryConfigHeaders:a});try{await this._connectWebSocket(t)}catch(h){this._logStartSubscriptionError(r,n,h);return}const{subscriptionFailedCallback:d,subscriptionReadyCallback:l}=this.subscriptionObserverMap.get(r)??{};this.subscriptionObserverMap.set(r,{observer:n,subscriptionState:$.PENDING,query:i??"",variables:s??{},subscriptionReadyCallback:l,subscriptionFailedCallback:d,startAckTimeoutId:setTimeout(()=>{this._timeoutStartSubscriptionAck(r)},uc)}),this.awsRealTimeSocket&&this.awsRealTimeSocket.send(u)}_logStartSubscriptionError(t,n,r){this.logger.debug({err:r});const o=String(r.message??"");if(this.connectionStateMonitor.record(E.CLOSED),this.connectionState!==b.ConnectionDisruptedPendingNetwork){An(r)?n.error({errors:[{...new qe(`${D.CONNECTION_FAILED}: ${o}`)}]}):this.logger.debug(`${D.CONNECTION_FAILED}: ${o}`);const{subscriptionFailedCallback:i}=this.subscriptionObserverMap.get(t)||{};typeof i=="function"&&i()}}async _waitForSubscriptionToBeConnected(t){const n=this.subscriptionObserverMap.get(t);if(n){const{subscriptionState:r}=n;if(r===$.PENDING)return new Promise((o,i)=>{const{observer:s,subscriptionState:c,variables:a,query:u}=n;this.subscriptionObserverMap.set(t,{observer:s,subscriptionState:c,variables:a,query:u,subscriptionReadyCallback:o,subscriptionFailedCallback:i})})}}_sendUnsubscriptionMessage(t){try{if(this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.socketStatus===C.READY){const n=this._unsubscribeMessage(t),r=JSON.stringify(n);this.awsRealTimeSocket.send(r)}}catch(n){this.logger.debug({err:n})}}_removeSubscriptionObserver(t){this.subscriptionObserverMap.delete(t),setTimeout(this._closeSocketIfRequired.bind(this),1e3)}_closeSocketIfRequired(){if(!(this.subscriptionObserverMap.size>0)){if(!this.awsRealTimeSocket){this.socketStatus=C.CLOSED;return}if(this.connectionStateMonitor.record(E.CLOSING_CONNECTION),this.awsRealTimeSocket.bufferedAmount>0)setTimeout(this._closeSocketIfRequired.bind(this),1e3);else{this.logger.debug("closing WebSocket..."),this.keepAliveTimeoutId&&clearTimeout(this.keepAliveTimeoutId),this.keepAliveAlertTimeoutId&&clearTimeout(this.keepAliveAlertTimeoutId);const t=this.awsRealTimeSocket;t.onclose=null,t.onerror=null,t.close(1e3),this.awsRealTimeSocket=void 0,this.socketStatus=C.CLOSED,this.connectionStateMonitor.record(E.CLOSED)}}}_handleIncomingSubscriptionMessage(t){if(typeof t.data!="string")return;const[n,r]=this._handleSubscriptionData(t);if(n)return;const{type:o,id:i,payload:s}=r,{observer:c=null,query:a="",variables:u={},startAckTimeoutId:d,subscriptionReadyCallback:l,subscriptionFailedCallback:h}=this.subscriptionObserverMap.get(i)||{};if(o===k.GQL_START_ACK||o===k.EVENT_SUBSCRIBE_ACK){this.logger.debug(`subscription ready for ${JSON.stringify({query:a,variables:u})}`),typeof l=="function"&&l(),d&&clearTimeout(d),wn({event:D.SUBSCRIPTION_ACK,data:{query:a,variables:u},message:"Connection established for subscription"});const f=$.CONNECTED;c&&this.subscriptionObserverMap.set(i,{observer:c,query:a,variables:u,startAckTimeoutId:void 0,subscriptionState:f,subscriptionReadyCallback:l,subscriptionFailedCallback:h}),this.connectionStateMonitor.record(E.CONNECTION_ESTABLISHED);return}if(o===k.GQL_CONNECTION_KEEP_ALIVE){this.keepAliveTimeoutId&&clearTimeout(this.keepAliveTimeoutId),this.keepAliveAlertTimeoutId&&clearTimeout(this.keepAliveAlertTimeoutId),this.keepAliveTimeoutId=setTimeout(()=>{this._errorDisconnect(D.TIMEOUT_DISCONNECT)},this.keepAliveTimeout),this.keepAliveAlertTimeoutId=setTimeout(()=>{this.connectionStateMonitor.record(E.KEEP_ALIVE_MISSED)},dc),this.connectionStateMonitor.record(E.KEEP_ALIVE);return}if(o===k.GQL_ERROR){const f=$.FAILED;c&&(this.subscriptionObserverMap.set(i,{observer:c,query:a,variables:u,startAckTimeoutId:d,subscriptionReadyCallback:l,subscriptionFailedCallback:h,subscriptionState:f}),this.logger.debug(`${D.CONNECTION_FAILED}: ${JSON.stringify(s??r)}`),c.error({errors:[{...new qe(`${D.CONNECTION_FAILED}: ${JSON.stringify(s??r)}`)}]}),d&&clearTimeout(d),typeof h=="function"&&h())}}_errorDisconnect(t){this.logger.debug(`Disconnect error: ${t}`),this.awsRealTimeSocket&&(this.connectionStateMonitor.record(E.CLOSED),this.awsRealTimeSocket.close()),this.socketStatus=C.CLOSED}_timeoutStartSubscriptionAck(t){const n=this.subscriptionObserverMap.get(t);if(n){const{observer:r,query:o,variables:i}=n;if(!r)return;this.subscriptionObserverMap.set(t,{observer:r,query:o,variables:i,subscriptionState:$.FAILED}),this.connectionStateMonitor.record(E.CLOSED),this.logger.debug("timeoutStartSubscription",JSON.stringify({query:o,variables:i}))}}_initializeWebSocketConnection({appSyncGraphqlEndpoint:t,authenticationType:n,apiKey:r,region:o,additionalCustomHeaders:i}){if(this.socketStatus!==C.READY)return new Promise(async(s,c)=>{if(this.promiseArray.push({res:s,rej:c}),this.socketStatus===C.CLOSED)try{this.socketStatus=C.CONNECTING;const u=await Ar({authenticationType:n,payload:"{}",canonicalUri:this.wsConnectUri,apiKey:r,appSyncGraphqlEndpoint:t,region:o,additionalCustomHeaders:i}),d=u?JSON.stringify(u):"",h=`header-${Hs.convert(d,{urlSafe:!0,skipPadding:!0})}`,f=vc(i),p=Ic(t,f);await this._establishRetryableConnection(p,h),this.promiseArray.forEach(({res:g})=>{this.logger.debug("Notifying connection successful"),g()}),this.socketStatus=C.READY,this.promiseArray=[]}catch(a){this.logger.debug("Connection exited with",a),this.promiseArray.forEach(({rej:u})=>{u(a)}),this.promiseArray=[],this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.awsRealTimeSocket.close(3001),this.awsRealTimeSocket=void 0,this.socketStatus=C.CLOSED}})}async _establishRetryableConnection(t,n){this.logger.debug("Establishing retryable connection"),await $s(this._establishConnection.bind(this),[t,n],oc)}async _openConnection(t,n){return new Promise((r,o)=>{const i=this._getNewWebSocket(t,[this.wsProtocolName,n]);i.onerror=()=>{this.logger.debug("WebSocket connection error")},i.onclose=()=>{o(new Error("Connection handshake error"))},i.onopen=()=>{this.awsRealTimeSocket=i,r()}})}_getNewWebSocket(t,n){return new WebSocket(t,n)}async _initiateHandshake(){return new Promise((t,n)=>{if(!this.awsRealTimeSocket){n(new Error("awsRealTimeSocket undefined"));return}let r=!1;this.awsRealTimeSocket.onerror=s=>{this.logger.debug(`WebSocket error ${JSON.stringify(s)}`)},this.awsRealTimeSocket.onclose=s=>{this.logger.debug(`WebSocket closed ${s.reason}`),n(new Error(JSON.stringify(s)))},this.awsRealTimeSocket.onmessage=s=>{if(typeof s.data!="string")return;this.logger.debug(`subscription message from AWS AppSyncRealTime: ${s.data} `);const c=JSON.parse(s.data),{type:a}=c,u=this._extractConnectionTimeout(c);if(a===k.GQL_CONNECTION_ACK){r=!0,this._registerWebsocketHandlers(u),t("Connected to AWS AppSyncRealTime");return}if(a===k.GQL_CONNECTION_ERROR){const{errorType:d,errorCode:l}=this._extractErrorCodeAndType(c);n({errorType:d,errorCode:l})}};const o={type:k.GQL_CONNECTION_INIT};this.awsRealTimeSocket.send(JSON.stringify(o));const i=s=>{s||(this.connectionStateMonitor.record(E.CONNECTION_FAILED),n(new Error(`Connection timeout: ack from AWSAppSyncRealTime was not received after ${hn} ms`)))};setTimeout(()=>{i(r)},hn)})}_registerWebsocketHandlers(t){this.awsRealTimeSocket&&(this.keepAliveTimeout=t,this.awsRealTimeSocket.onmessage=this._handleIncomingSubscriptionMessage.bind(this),this.awsRealTimeSocket.onerror=n=>{this.logger.debug(n),this._errorDisconnect(D.CONNECTION_CLOSED)},this.awsRealTimeSocket.onclose=n=>{this.logger.debug(`WebSocket closed ${n.reason}`),this._errorDisconnect(D.CONNECTION_CLOSED)})}}class W extends N{constructor(t){super(t),this.constructor=W,Object.setPrototypeOf(this,W.prototype)}}const Cr=e=>{const t=e.libraryOptions?.API?.GraphQL?.headers,n=e.libraryOptions?.API?.GraphQL?.withCredentials;return{headers:t,withCredentials:n}};function Cc(e){return e.errors&&Array.isArray(e.errors)&&e.errors.forEach(t=>{Tc(t)&&(t.message="Unauthorized",t.recoverySuggestion=`If you're calling an Amplify-generated API, make sure to set the "authMode" in generateClient({ authMode: '...' }) to the backend authorization rule's auth provider ('apiKey', 'userPool', 'iam', 'oidc', 'lambda')`)}),e}function Tc(e){return!!(e?.originalError?.name?.startsWith("UnauthorizedException")||e.message?.startsWith("Connection failed:")&&e.message?.includes("Permission denied"))}var q;(function(e){e.NO_API_KEY="No api-key configured",e.NO_CURRENT_USER="No current user",e.NO_CREDENTIALS="No credentials",e.NO_FEDERATED_JWT="No federated jwt",e.NO_AUTH_TOKEN="No auth token specified"})(q||(q={}));const Oc={name:"NoApiKey",message:q.NO_API_KEY,recoverySuggestion:'The API request was made with `authMode: "apiKey"` but no API Key was passed into `Amplify.configure()`. Review if your API key is passed into the `Amplify.configure()` function.'},kc={name:"NoCredentials",message:q.NO_CREDENTIALS,recoverySuggestion:'The API request was made with `authMode: "iam"` but no authentication credentials are available.\n\nIf you intended to make a request using an authenticated role, review if your user is signed in before making the request.\n\nIf you intend to make a request using an unauthenticated role or also known as "guest access", verify if "Auth.Cognito.allowGuestAccess" is set to "true" in the `Amplify.configure()` function.'},Nc={name:"NoValidAuthTokens",message:q.NO_FEDERATED_JWT,recoverySuggestion:"If you intended to make an authenticated API request, review if the current user is signed in."},Rc={name:"NoSignedUser",message:q.NO_CURRENT_USER,recoverySuggestion:"Review the underlying exception field for more details. If you intended to make an authenticated API request, review if the current user is signed in."},Pc={name:"NoAuthorizationHeader",message:q.NO_AUTH_TOKEN,recoverySuggestion:'The API request was made with `authMode: "lambda"` but no `authToken` is set. Review if a valid authToken is passed into the request options or in the `Amplify.configure()` function.'};function xc(e){if(!e)return!1;const t=e;return Array.isArray(t.errors)&&t.errors.length>0}async function Dc(e,t,n,r={}){let o={};switch(t){case"apiKey":if(!n)throw new W(Oc);o={"X-Api-Key":n};break;case"iam":{if((await e.Auth.fetchAuthSession()).credentials===void 0)throw new W(kc);break}case"oidc":case"userPool":{let i;try{i=(await e.Auth.fetchAuthSession()).tokens?.accessToken.toString()}catch(s){throw new W({...Rc,underlyingError:s})}if(!i)throw new W(Nc);o={Authorization:i};break}case"lambda":if(typeof r=="object"&&!r.Authorization)throw new W(Pc);o={Authorization:r.Authorization};break}return o}const vn="AWSAppSyncEventsProvider",Lc="aws-appsync-event-ws",Mc="";class Uc extends Ac{constructor(){super({providerName:vn,wsProtocolName:Lc,connectUri:Mc})}getProviderName(){return vn}async connect(t){super.connect(t)}subscribe(t,n){return super.subscribe(t,n).pipe()}async publish(t,n){super.publish(t,n)}async _prepareSubscriptionPayload({options:t,subscriptionId:n,customUserAgentDetails:r,additionalCustomHeaders:o,libraryConfigHeaders:i,publish:s}){const{appSyncGraphqlEndpoint:c,authenticationType:a,query:u,apiKey:d,region:l}=t,h=JSON.stringify({channel:u}),f={...await Ar({apiKey:d,appSyncGraphqlEndpoint:c,authenticationType:a,payload:h,canonicalUri:"",region:l,additionalCustomHeaders:o}),...i,...o,[Kr]:ge(r)},p={id:n,channel:u,authorization:{...f},type:s?k.EVENT_PUBLISH:k.EVENT_SUBSCRIBE};return JSON.stringify(p)}_handleSubscriptionData(t){this.logger.debug(`subscription message from AWS AppSync Events: ${t.data}`);const{id:n="",event:r,type:o}=JSON.parse(String(t.data)),{observer:i=null,query:s="",variables:c={}}=this.subscriptionObserverMap.get(n)||{};if(this.logger.debug({id:n,observer:i,query:s,variables:c}),o===k.DATA&&r){const a=JSON.parse(r);return i?i.next({id:n,type:o,event:a}):this.logger.debug(`observer not found for id: ${n}`),[!0,{id:n,type:o,payload:a}]}return[!1,{id:n,type:o,payload:r}]}_unsubscribeMessage(t){return{id:t,type:k.EVENT_STOP}}_extractConnectionTimeout(t){const{connectionTimeoutMs:n=_r}=t;return n}_extractErrorCodeAndType(t){const{errors:[{errorType:n="",errorCode:r=0}={}]=[]}=t;return{errorCode:r,errorType:n}}}const In=new Uc,Kc="x-amz-user-agent";async function $c(e,t,n={},r,o){const{region:i,appSyncGraphqlEndpoint:s,authenticationType:c,query:a,variables:u}=t;if(!s)throw new Error("No endpoint");const{withCredentials:d}=Cr(e),l=await Vc(e,t,n,o),h={channel:a,events:u},f=["apiKey","none"].includes(c)?void 0:{service:"appsync",region:i},{body:p}=await rc(e,{url:new F(s),options:{headers:l,body:h,signingServiceInfo:f,withCredentials:d},abortController:r}),g=await p.json();if(xc(g))throw Cc(g);return g}async function Vc(e,t,n,r){const{apiKey:o,appSyncGraphqlEndpoint:i,authenticationType:s,query:c,variables:a}=t,{headers:u}=Cr(e);let d;if(typeof n=="function"){const p={method:"POST",url:new F(i).toString(),queryString:c};d=await n(p)}else d=n;const l=await Dc(e,s,o,d),h=u&&await u({query:c,variables:a});return{...l,...h,...d,[Kc]:ge(r)}}const Le=(e,t)=>e?e==="identityPool"?"iam":e:t,Tr=()=>{const t=L.getConfig().API?.Events;if(!t)throw new Error("Amplify configuration is missing. Have you called Amplify.configure()?");const n=Le(t.defaultAuthMode,"apiKey");return{appSyncGraphqlEndpoint:t.endpoint,region:t.region,authenticationType:n,apiKey:t.apiKey}},Wc=e=>{if(Array.isArray(e))return e.map((n,r)=>{const o=JSON.stringify(n);if(o===void 0)throw new Error(`Event must be a valid JSON value. Received ${n} at index ${r}`);return o});const t=JSON.stringify(e);if(t===void 0)throw new Error(`Event must be a valid JSON value. Received ${e}`);return[t]};async function Fc(e,t){const n=Tr();n.authenticationType=Le(t?.authMode,n.authenticationType),await In.connect(n);let r;return{subscribe:(s,c)=>{const a={...n,query:e};return a.authenticationType=Le(c?.authMode,a.authenticationType),r=In.subscribe(a).subscribe(s),r},close:()=>{r&&r.unsubscribe()}}}async function Hc(e,t,n){const r=Tr();r.authenticationType=Le(n?.authMode,r.authenticationType);const o=e[0]==="/"?e:`/${e}`,i={...r,query:o,variables:Wc(t)},s=new AbortController,c=await $c(L,i,{},s);if(c.failed?.length>0)return c.failed}Pa.configure({API:{Events:{endpoint:"https://ws2ll764grdmbmlqpxzsnkvvfa.appsync-api.us-east-1.amazonaws.com/event",region:"us-east-1",defaultAuthMode:"apiKey",apiKey:"da2-ovdidjfcd5e7xmqsnnimapmgce"}}});const Gc=await Fc("/default/test");Gc.subscribe({next:e=>{document.getElementById("eventsLog").insertAdjacentText("beforeend",e.event.message+`
`)},error:e=>console.error("error",e)});window.publishEvent=()=>{const e=document.getElementById("messageId");Hc("/default/test",{message:e.value}),e.value=""};
